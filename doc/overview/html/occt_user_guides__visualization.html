<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>Open CASCADE Technology: Visualization</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="occ_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Open CASCADE Technology
   &#160;<span id="projectnumber">7.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('occt_user_guides__visualization.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Visualization </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#occt_visu_1">Introduction</a></li>
<li class="level1"><a href="#occt_visu_2">Fundamental Concepts</a><ul><li class="level2"><a href="#occt_visu_2_1">Presentation</a><ul><li class="level3"><a href="#occt_visu_2_1_1">Structure of  the Presentation</a></li>
<li class="level3"><a href="#occt_visu_2_1_2">Presentation packages</a></li>
<li class="level3"><a href="#occt_visu_2_1_3">A Basic Example: How to display a 3D object</a></li>
</ul>
</li>
<li class="level2"><a href="#occt_visu_2_2">Selection</a><ul><li class="level3"><a href="#occt_visu_2_2_1">Terms and notions</a></li>
<li class="level3"><a href="#occt_visu_2_2_2">Algorithm</a></li>
<li class="level3"><a href="#occt_visu_2_2_3">Packages and classes</a></li>
<li class="level3"><a href="#occt_visu_2_2_4">Examples of usage</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#occt_visu_3">Application Interactive Services</a><ul><li class="level2"><a href="#occt_visu_3_1">Introduction</a></li>
<li class="level2"><a href="#occt_visu_3_2">Interactive objects</a><ul><li class="level3"><a href="#occt_visu_3_2_1">Presentations</a></li>
<li class="level3"><a href="#occt_visu_3_2_2">Hidden Line Removal</a></li>
<li class="level3"><a href="#occt_visu_3_2_3">Presentation modes</a></li>
<li class="level3"><a href="#occt_visu_3_2_4">Selection</a></li>
<li class="level3"><a href="#occt_visu_3_2_5">Graphic attributes</a></li>
<li class="level3"><a href="#occt_visu_3_2_6">Complementary  Services</a></li>
</ul>
</li>
<li class="level2"><a href="#occt_visu_3_3">Interactive Context</a><ul><li class="level3"><a href="#occt_visu_3_3_1">Rules</a></li>
<li class="level3"><a href="#occt_visu_3_3_2">Groups of functions</a></li>
<li class="level3"><a href="#occt_visu_3_3_3">Management of the Interactive Context</a></li>
</ul>
</li>
<li class="level2"><a href="#occt_visu_3_4">Local Context</a><ul><li class="level3"><a href="#occt_visu_3_4_1">Rules and Conventions</a></li>
<li class="level3"><a href="#occt_visu_3_4_2">Management of Local Context</a></li>
<li class="level3"><a href="#occt_visu_3_4_3">Presentation in a Neutral Point</a></li>
<li class="level3"><a href="#occt_visu_3_4_4">Presentation in the Local Context</a></li>
<li class="level3"><a href="#occt_visu_3_4_5">Filters</a></li>
<li class="level3"><a href="#occt_visu_3_4_6">Selection in the Local Context</a></li>
<li class="level3"><a href="#occt_visu_3_4_7">Recommendations</a></li>
</ul>
</li>
<li class="level2"><a href="#occt_visu_3_5">Standard Interactive Object Classes</a><ul><li class="level3"><a href="#occt_visu_3_5_1">Datum</a></li>
<li class="level3"><a href="#occt_visu_3_5_2">Object</a></li>
<li class="level3"><a href="#occt_visu_3_5_3">Relations</a></li>
<li class="level3"><a href="#occt_visu_3_5_4">Dimensions</a></li>
<li class="level3"><a href="#occt_visu_3_5_5">MeshVS_Mesh</a></li>
</ul>
</li>
<li class="level2"><a href="#occt_visu_3_6">Dynamic Selection</a></li>
</ul>
</li>
<li class="level1"><a href="#occt_visu_4">3D Presentations</a><ul><li class="level2"><a href="#occt_visu_4_1">Glossary of 3D terms</a></li>
<li class="level2"><a href="#occt_visu_4_2">Graphic primitives</a><ul><li class="level3"><a href="#occt_visu_4_2_2">Structure hierarchies</a></li>
<li class="level3"><a href="#occt_visu_4_2_3">Graphic primitives</a></li>
<li class="level3"><a href="#occt_visu_4_2_4">Primitive  arrays</a></li>
<li class="level3"><a href="#occt_visu_4_2_5">Text primitive</a></li>
<li class="level3"><a href="#occt_visu_4_2_6">Materials</a></li>
<li class="level3"><a href="#occt_visu_4_2_7">Textures</a></li>
<li class="level3"><a href="#occt_visu_4_2_8">Shaders</a></li>
</ul>
</li>
<li class="level2"><a href="#occt_visu_4_3">Graphic attributes</a><ul><li class="level3"><a href="#occt_visu_4_3_1">Aspect package overview</a></li>
</ul>
</li>
<li class="level2"><a href="#occt_visu_4_4">3D view facilities</a><ul><li class="level3"><a href="#occt_visu_4_4_1">Overview</a></li>
<li class="level3"><a href="#occt_visu_4_4_2">A programming example</a></li>
<li class="level3"><a href="#occt_visu_4_4_3">Define viewing parameters</a></li>
<li class="level3"><a href="#occt_visu_4_4_4">Orthographic Projection</a></li>
<li class="level3"><a href="#occt_visu_4_4_5">Perspective Projection</a></li>
<li class="level3"><a href="#occt_visu_4_4_6">Stereographic Projection</a></li>
<li class="level3"><a href="#occt_visu_4_4_7">View frustum culling</a></li>
<li class="level3"><a href="#occt_visu_4_4_8">Underlay and overlay layers management</a></li>
<li class="level3"><a href="#occt_visu_4_4_9">View background styles</a></li>
<li class="level3"><a href="#occt_visu_4_4_10">Dumping a 3D scene into an image file</a></li>
<li class="level3"><a href="#occt_visu_4_4_11">Printing a 3D scene</a></li>
<li class="level3"><a href="#occt_visu_4_4_12">Vector image export</a></li>
<li class="level3"><a href="#occt_visu_4_4_13">Ray tracing support</a></li>
<li class="level3"><a href="#occt_visu_4_4_14">Display priorities</a></li>
<li class="level3"><a href="#occt_visu_4_4_15">Z-layer support</a></li>
<li class="level3"><a href="#occt_visu_4_4_16">Clipping planes</a></li>
<li class="level3"><a href="#occt_visu_4_4_17">Automatic back face culling</a></li>
</ul>
</li>
<li class="level2"><a href="#occt_visu_4_5">Examples: creating a 3D scene</a><ul><li class="level3"><a href="#occt_visu_4_5_1">Create attributes</a></li>
<li class="level3"><a href="#occt_visu_4_5_2">Create a 3D Viewer (a Windows example)</a></li>
<li class="level3"><a href="#occt_visu_4_5_3">Create a 3D view (a Windows example)</a></li>
<li class="level3"><a href="#occt_visu_4_5_4">Create an interactive context</a></li>
<li class="level3"><a href="#occt_visu_4_5_5">Create your own interactive object</a></li>
<li class="level3"><a href="#occt_visu_4_5_6">Create primitives in the interactive object</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#occt_visu_5">Mesh Visualization Services</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="occt_visu_1"></a>
Introduction</h1>
<p>Visualization in Open CASCADE Technology is based on the separation of:</p><ul>
<li>on the one hand &ndash; the data which stores the geometry and topology of the entities you want to display and select, and</li>
<li>on the other hand &ndash; its <b>presentation</b> (what you see when an object is displayed in a scene) and <b>selection</b> (possibility to choose the whole object or its sub-parts interactively to apply application-defined operations to the selected entities).</li>
</ul>
<p>Presentations are managed through the <b>Presentation</b> component, and selection through the <b>Selection</b> component.</p>
<p><b>Application Interactive Services</b> (<a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a>) provides the means to create links between an application GUI viewer and the packages, which are used to manage selection and presentation, which makes management of these functionalities in 3D more intuitive and consequently, more transparent.</p>
<p><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a></em> uses the notion of the <em>interactive object</em>, a displayable and selectable entity, which represents an element from the application data. As a result, in 3D, you, the user, have no need to be familiar with any functions underlying <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a> unless you want to create your own interactive objects or selection filters.</p>
<p>If, however, you require types of interactive objects and filters other than those provided, you will need to know the mechanics of presentable and selectable objects, specifically how to implement their virtual functions. To do this requires familiarity with such fundamental concepts as the sensitive primitive and the presentable object.</p>
<p>The the following packages are used to display 3D objects:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a></em>;</li>
<li><em>StdPrs</em>;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_prs3d.html">Prs3d</a></em>;</li>
<li><em>PrsMgr</em>;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_v3d.html">V3d</a></em>;</li>
<li><em>Graphic3d</em>.</li>
</ul>
<p>The packages used to display 3D objects are also applicable for visualization of 2D objects.</p>
<p>The figure below presents a schematic overview of the relations between the key concepts and packages in visualization. Naturally, "Geometry &amp; Topology" is just an example of application data that can be handled by <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a></em>, and application-specific interactive objects can deal with any kind of data.</p>
<div class="image">
<img src="visualization_image003.png" alt="visualization_image003.png"/>
<div class="caption">
Key concepts and packages in visualization</div></div>
 To answer different needs of CASCADE users, this User's Guide offers the following three paths in reading it.</p>
<ul>
<li>If the 3D services proposed in <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a> meet your requirements, you need only read chapter 3 <a class="el" href="occt_user_guides__visualization.html#occt_visu_3">AIS: Application Interactive Services</a>.</li>
<li>If you need more detail, for example, a selection filter on another type of entity &ndash; you should read chapter 2 <a class="el" href="occt_user_guides__visualization.html#occt_visu_2">Fundamental Concepts</a>, chapter 3 <a class="el" href="occt_user_guides__visualization.html#occt_visu_3">AIS: Application Interactive Services</a>, and 4 <a class="el" href="occt_user_guides__visualization.html#occt_visu_4">3D Presentations</a>. You may want to begin with the chapter presenting <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a>.</li>
</ul>
<p>For advanced information on visualization algorithms, see our <a href="http://www.opencascade.com/content/tutorial-learning">E-learning &amp; Training</a> offerings.</p>
<h1><a class="anchor" id="occt_visu_2"></a>
Fundamental Concepts</h1>
<h2><a class="anchor" id="occt_visu_2_1"></a>
Presentation</h2>
<p>In Open CASCADE Technology, presentation services are separated from the data, which they represent, which is generated by applicative algorithms. This division allows you to modify a geometric or topological algorithm and its resulting objects without modifying the visualization services.</p>
<h3><a class="anchor" id="occt_visu_2_1_1"></a>
Structure of  the Presentation</h3>
<p>Displaying an object on the screen involves three kinds of entities:</p><ul>
<li>a presentable object, the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html">AIS_InteractiveObject</a></em></li>
<li>a viewer</li>
<li>an interactive context, the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html">AIS_InteractiveContext</a></em>.</li>
</ul>
<h4>The presentable object</h4>
<p>The purpose of a presentable object is to provide the graphical representation of an object in the form of <em>Graphic3d</em> structure. On the first display request, it creates this structure by calling the appropriate algorithm and retaining this framework for further display.</p>
<p><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_standard.html">Standard</a> presentation algorithms are provided in the <em>StdPrs</em> and <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_prs3d.html">Prs3d</a></em> packages. You can, however, write specific presentation algorithms of your own, provided that they create presentations made of structures from the <em>Graphic3d</em> packages. You can also create several presentations of a single presentable object: one for each visualization mode supported by your application.</p>
<p>Each object to be presented individually must be presentable or associated with a presentable object.</p>
<h4>The viewer </h4>
<p>The viewer allows interactively manipulating views of the object. When you zoom, translate or rotate a view, the viewer operates on the graphic structure created by the presentable object and not on the data model of the application. Creating Graphic3d structures in your presentation algorithms allows you to use the 3D viewers provided in Open CASCADE Technology for 3D visualisation.</p>
<h4>The Interactive Context </h4>
<p>The interactive context controls the entire presentation process from a common high-level API. When the application requests the display of an object, the interactive context requests the graphic structure from the presentable object and sends it to the viewer for displaying.</p>
<h3><a class="anchor" id="occt_visu_2_1_2"></a>
Presentation packages</h3>
<p>Presentation involves at least the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a>, PrsMgr, StdPrs</em> and <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_v3d.html">V3d</a></em> packages. Additional packages, such as <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_prs3d.html">Prs3d</a></em> and <em>Graphic3d</em> may be used if you need to implement your own presentation algorithms.</p>
<ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a></em> package provides all classes to implement interactive objects (presentable and selectable entities).</li>
<li><em>PrsMgr</em> package provides low level services and is only to be used when you do not want to use the services provided by <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a>. It contains all classes needed to implement the presentation process: abstract classes <em>Presentation</em> and <em>PresentableObject</em> and concrete class <em>PresentationManager3d</em>.</li>
<li><em>StdPrs</em> package provides ready-to-use standard presentation algorithms for specific geometries: points, curves and shapes of the geometry and topology toolkits.</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_prs3d.html">Prs3d</a></em> package provides generic presentation algorithms such as wireframe, shading and hidden line removal associated with a <em>Drawer</em> class, which controls the attributes of the presentation to be created in terms of color, line type, thickness, etc.</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_v3d.html">V3d</a></em> package provides the services supported by the 3D viewer.</li>
<li><em>Graphic3d</em> package provides resources to create 3D graphic structures.</li>
<li><em>Visual3d</em> package contains classes implementing commands for 3D viewer.</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_dsg_prs.html">DsgPrs</a></em> package provides tools for display of dimensions, relations and XYZ trihedrons.</li>
</ul>
<h3><a class="anchor" id="occt_visu_2_1_3"></a>
A Basic Example: How to display a 3D object</h3>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Void Standard_Real dx  = ...; //Parameters   </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Void Standard_Real dy  = ...; //to build  a wedge  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Void Standard_Real dz  = ...;  </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Void Standard_Real ltx = ...; </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Handle(V3d_Viewer)aViewer = ...;  </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Handle(AIS_InteractiveContext)aContext;  </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;aContext = new AIS_InteractiveContext(aViewer);     </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;BRepPrimAPI_MakeWedge w(dx, dy, dz, ltx);  </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;TopoDS_Solid &amp; = w.Solid();  </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;Handle(AIS_Shape) anAis = new AIS_Shape(S);  </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;//creation of the presentable  object  </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;aContext -&gt; Display(anAis);  </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;//Display the presentable  object in the 3d viewer. </div>
</div><!-- fragment --><p>The shape is created using the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_b_rep_prim_a_p_i___make_wedge.html">BRepPrimAPI_MakeWedge</a></em> command. An <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a></em> is then created from the shape. When calling the <em>Display</em> command, the interactive context calls the Compute method of the presentable object to calculate the presentation data and transfer it to the viewer. See figure below.</p>
<div class="image">
<img src="visualization_image004.svg" alt="visualization_image004.svg"/>
<div class="caption">
Processes involved in displaying a presentable shape</div></div>
 <h2><a class="anchor" id="occt_visu_2_2"></a>
Selection</h2>
<p><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_standard.html">Standard</a> OCCT selection algorithm is represented by 2 parts: dynamic and static. Dynamic selection causes objects to be automatically highlighted as the mouse cursor moves over them. Static selection allows to pick particular object (or objects) for further processing.</p>
<p>There are 3 different selection types:</p><ul>
<li><b>Point selection</b> &ndash; allows picking and highlighting a single object (or its part) located under the mouse cursor;</li>
<li><b>Rectangle selection</b> &ndash; allows picking objects or parts located under the rectangle defined by the start and end mouse cursor positions;</li>
<li><b>Polyline selection</b> &ndash; allows picking objects or parts located under a user-defined non-self-intersecting polyline.</li>
</ul>
<p>For OCCT selection algorithm, all selectable objects are represented as a set of sensitive zones, called <b>sensitive entities</b>. When the mouse cursor moves in the view, the sensitive entities of each object are analyzed for collision.</p>
<h3><a class="anchor" id="occt_visu_2_2_1"></a>
Terms and notions</h3>
<p>This section introduces basic terms and notions used throughout the algorithm description.</p>
<h4>Sensitive entity</h4>
<p>Sensitive entities in the same way as entity owners are links between objects and the selection mechanism.</p>
<p>The purpose of entities is to define what parts of the object will be selectable in particular. Thus, any object that is meant to be selectable must be split into sensitive entities (one or several). For instance, to apply face selection to an object it is necessary to explode it into faces and use them for creation of a sensitive entity set.</p>
<div class="image">
<img src="visualization_image005.png" alt="visualization_image005.png"/>
<div class="caption">
Example of a shape divided into sensitive entities</div></div>
 Depending on the user's needs, sensitive entities may be atomic (point or edge) or complex. Complex entities contain many sub-elements that can be handled by detection mechanism in a similar way (for example, a polyline stored as a set of line segments or a triangulation).</p>
<p>Entities are used as internal units of the selection algorithm and do not contain any topological data, hence they have a link to an upper-level interface that maintains topology-specific methods.</p>
<h4>Entity owner</h4>
<p>Each sensitive entity stores a reference to its owner, which is a class connecting the entity and the corresponding selectable object. Besides, owners can store any additional information, for example, the topological shape of the sensitive entity, highlight colors and methods, or if the entity is selected or not.</p>
<h4>Selection</h4>
<p>To simplify the handling of different selection modes of an object, sensitive entities linked to its owners are organized into sets, called <b>selections</b>.</p>
<p>Each selection contains entities created for a certain mode along with the sensitivity and update states.</p>
<h4>Selectable object</h4>
<p>Selectable object stores information about all created selection modes and sensitive entities.</p>
<p>All successors of a selectable object must implement the method that splits its presentation into sensitive entities according to the given mode. The computed entities are arranged in one selection and added to the list of all selections of this object. No selection will be removed from the list until the object is deleted permanently.</p>
<p>For all standard OCCT shapes, zero mode is supposed to select the whole object (but it may be redefined easily in the custom object). For example, the standard OCCT selection mechanism and <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a></em> determine the following modes:</p><ul>
<li>0 &ndash; selection of the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a></em>;</li>
<li>1 &ndash; selection of the vertices;</li>
<li>2 &ndash; selection of the edges;</li>
<li>3 &ndash; selection of the wires;</li>
<li>4 &ndash; selection of the faces;</li>
<li>5 &ndash; selection of the shells;</li>
<li>6 &ndash; selection of the constituent solids.</li>
</ul>
<div class="image">
<img src="visualization_image006.png" alt="visualization_image006.png"/>
<div class="caption">
Hierarchy of references from sensitive entity to selectable object</div></div>
 <div class="image">
<img src="visualization_image007.png" alt="visualization_image007.png"/>
<div class="caption">
The principle of entities organization within the selectable object</div></div>
 <h4>Viewer selector</h4>
<p>For each OCCT viewer there is a <b>Viewer selector</b> class instance. It provides a high-level API for the whole selection algorithm and encapsulates the processing of objects and sensitive entities for each mouse pick.</p>
<p>The viewer selector maintains activation and deactivation of selection modes, launches the algorithm, which detects candidate entities to be picked, and stores its results, as well as implements an interface for keeping selection structures up-to-date.</p>
<h4>Selection manager</h4>
<p>Selection manager is a high-level API to manipulate selection of all displayed objects. It handles all viewer selectors, activates and deactivates selection modes for the objects in all or particular selectors, manages computation and update of selections for each object. Moreover, it keeps selection structures updated taking into account applied changes.</p>
<div class="image">
<img src="visualization_image008.png" alt="visualization_image008.png"/>
<div class="caption">
The relations chain between viewer selector and selection manager</div></div>
 <h3><a class="anchor" id="occt_visu_2_2_2"></a>
Algorithm</h3>
<p>All three types of OCCT selection are implemented as a single concept, based on the search for overlap between frustum and sensitive entity through 3-level <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> tree traversal.</p>
<h4>Selection Frustum</h4>
<p>The first step of each run of selection algorithm is to build the selection frustum according to the currently activated selection type.</p>
<p>For the point or the rectangular selection the base of the frustum is a rectangle built in conformity with the pixel tolerance or the dimensions of a user-defined area, respectively. For the polyline selection, the polygon defined by the constructed line is triangulated and each triangle is used as the base for its own frustum. Thus, this type of selection uses a set of triangular frustums for overlap detection.</p>
<p>The frustum length is limited by near and far view volume planes and each plane is built parallel to the corresponding view volume plane.</p>
<div class="image">
<img src="visualization_image009.png" alt="visualization_image009.png"/>
<div class="caption">
Rectangular frustum: a) after mouse move or click, b) after applying the rectangular selection</div></div>
 <div class="image">
<img src="visualization_image010.png" alt="visualization_image010.png"/>
<div class="caption">
Triangular frustum set: a) user-defined polyline, b) triangulation of the polygon based on the given polyline, c) triangular frustum based on one of the triangles</div></div>
 <h4><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> trees</h4>
<p>To maintain selection mechanism at the viewer level, a speedup structure composed of 3 <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> trees is used.</p>
<p>The first level tree is constructed of axis-aligned bounding boxes of each selectable object. Hence, the root of this tree contains the combination of all selectable boundaries even if they have no currently activated selections. Objects are added during the display of <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html">AIS_InteractiveObject</a></em> and will be removed from this tree only when the object is destroyed. The 1st level <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> tree is build on demand simultaneously with the first run of the selection algorithm.</p>
<p>The second level <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> tree consists of all sensitive entities of one selectable object. The 2nd level trees are built automatically when the default mode is activated and rebuilt whenever a new selection mode is calculated for the first time.</p>
<p>The third level <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> tree is used for complex sensitive entities that contain many elements: for example, triangulations, wires with many segments, point sets, etc. It is built on demand for sensitive entities with under 800K sub-elements.</p>
<div class="image">
<img src="visualization_image022.png" alt="visualization_image022.png"/>
<div class="caption">
Selection BVH tree hierarchy: from the biggest object-level (first) to the smallest complex entity level (third)</div></div>
 <h4>Stages of the algorithm</h4>
<p>The algorithm includes pre-processing and three main stages.</p>
<ul>
<li><b>Pre-processing</b> &ndash; implies calculation of the selection frustum and its main characteristics.</li>
<li><b>First stage</b> &ndash; traverse of the first level <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> tree.</li>
</ul>
<p>After successful building of the selection frustum, the algorithm starts traversal of the object-level <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> tree. The nodes containing axis-aligned bounding boxes are tested for overlap with the selection frustum following the terms of <em>separating axis theorem (SAT)</em>. When the traverse goes down to the leaf node, it means that a candidate object with possibly overlapping sensitive entities has been found. If no such objects have been detected, the algorithm stops and it is assumed that no object needs to be selected. Otherwise it passes to the next stage to process the entities of the found selectable.</p>
<ul>
<li><b>Second stage</b> &ndash; traverse of the second level <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> tree</li>
</ul>
<p>At this stage it is necessary to determine if there are candidates among all sensitive entities of one object.</p>
<p>First of all, at this stage the algorithm checks if there is any transformation applied for the current object. If it has its own location, then the correspondingly transformed frustum will be used for further calculations. At the next step the nodes of the second level <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> tree of the given object are visited to search for overlapping leaves. If no such leafs have been found, the algorithm returns to the second stage. Otherwise it starts processing the found entities by performing the following checks:</p><ul>
<li>activation check - the entity may be inactive at the moment as it belongs to deactivated selection;</li>
<li>tolerance check - current selection frustum may be too large for further checks as it is always built with the maximum tolerance among all activated entities. Thus, at this step the frustum may be scaled.</li>
</ul>
<p>After these checks the algorithm passes to the last stage.</p>
<ul>
<li><b>Third stage</b> &ndash; overlap or inclusion test of a particular sensitive entity</li>
</ul>
<p>If the entity is atomic, a simple SAT test is performed. In case of a complex entity, the third level <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> tree is traversed. The quantitative characteristics (like depth, distance to the center of geometry) of matched sensitive entities is analyzed and clipping planes are applied (if they have been set). The result of detection is stored and the algorithm returns to the second stage.</p>
<h3><a class="anchor" id="occt_visu_2_2_3"></a>
Packages and classes</h3>
<p>Selection is implemented as a combination of various algorithms divided among several packages &ndash; <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_basics.html">SelectBasics</a></em>, <em>Select3D</em>, <em>SelectMgr</em> and <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_std_select.html">StdSelect</a></em>.</p>
<h4><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_basics.html">SelectBasics</a></h4>
<p><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_basics.html">SelectBasics</a></em> package contains basic classes and interfaces for selection. The most notable are:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_basics___sensitive_entity.html">SelectBasics_SensitiveEntity</a></em> &ndash; the base definition of a sensitive entity;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_basics___entity_owner.html">SelectBasics_EntityOwner</a></em> &ndash; the base definition of the an entity owner &ndash; the link between the sensitive entity and the object to be selected;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/struct_select_basics___pick_result.html">SelectBasics_PickResult</a></em> &ndash; the structure for storing quantitative results of detection procedure, for example, depth and distance to the center of geometry;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_basics___selecting_volume_manager.html">SelectBasics_SelectingVolumeManager</a></em> &ndash; the interface for interaction with the current selection frustum.</li>
</ul>
<p>Each custom sensitive entity must inherit at least <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_basics___sensitive_entity.html">SelectBasics_SensitiveEntity</a></em>.</p>
<h4>Select3D</h4>
<p><em>Select3D</em> package provides a definition of standard sensitive entities, such as:</p><ul>
<li>box;</li>
<li>circle;</li>
<li>curve;</li>
<li>face;</li>
<li>group;</li>
<li>point;</li>
<li>segment;</li>
<li>triangle;</li>
<li>triangulation;</li>
<li>wire.</li>
</ul>
<p>Each basic sensitive entity inherits <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select3_d___sensitive_entity.html">Select3D_SensitiveEntity</a></em>, which is a child class of <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_basics___sensitive_entity.html">SelectBasics_SensitiveEntity</a></em>.</p>
<p>The package also contains two auxiliary classes, <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select3_d___sensitive_poly.html">Select3D_SensitivePoly</a></em> and <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select3_d___sensitive_set.html">Select3D_SensitiveSet</a></em>.</p>
<p><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select3_d___sensitive_poly.html">Select3D_SensitivePoly</a></em> &ndash; describes an arbitrary point set and implements basic functions for selection. It is important to know that this class does not perform any internal data checks. Hence, custom implementations of sensitive entity inherited from <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select3_d___sensitive_poly.html">Select3D_SensitivePoly</a></em> must satisfy the terms of Separating Axis Theorem to use standard OCCT overlap detection methods.</p>
<p><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select3_d___sensitive_set.html">Select3D_SensitiveSet</a></em> &ndash; a base class for all complex sensitive entities that require the third level <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> usage. It implements traverse of the tree and defines an interface for the methods that check sub-entities.</p>
<h4>SelectMgr</h4>
<p><em>SelectMgr</em> package is used to maintain the whole selection process. For this purpose, the package provides the following services:</p><ul>
<li>activation and deactivation of selection modes for all selectable objects;</li>
<li>interfaces to compute selection mode of the object;</li>
<li>definition of selection filter classes;</li>
<li>keeping selection <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> data up-to-date.</li>
</ul>
<p>A brief description of the main classes:</p><ul>
<li><em>SelectMgr_FrustumBase</em>, <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___frustum.html">SelectMgr_Frustum</a></em>, <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___rectangular_frustum.html">SelectMgr_RectangularFrustum</a></em>, <em>SelectMgr_TriangluarFrustum</em> and <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___triangular_frustum_set.html">SelectMgr_TriangularFrustumSet</a></em> &ndash; interfaces and implementations of selecting frustums, these classes implement different SAT tests for overlap and inclusion detection. They also contain methods to measure characteristics of detected entities (depth, distance to center of geometry);</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___sensitive_entity.html">SelectMgr_SensitiveEntity</a></em>, <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selection.html">SelectMgr_Selection</a></em> and <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___sensitive_entity_set.html">SelectMgr_SensitiveEntitySet</a></em> &ndash; store and handle sensitive entities; <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___sensitive_entity_set.html">SelectMgr_SensitiveEntitySet</a></em> implements a primitive set for the second level <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> tree;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object.html">SelectMgr_SelectableObject</a></em> and <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object_set.html">SelectMgr_SelectableObjectSet</a></em> &ndash; describe selectable objects. They also manage storage, calculation and removal of selections. <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object_set.html">SelectMgr_SelectableObjectSet</a></em> implements a primitive set for the first level <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> tree;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___viewer_selector.html">SelectMgr_ViewerSelector</a></em> &ndash; encapsulates all logics of the selection algorithm and implements the third level <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> tree traverse;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selection_manager.html">SelectMgr_SelectionManager</a></em> &ndash; manages activation/deactivation, calculation and update of selections of every selectable object, and keeps <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> data up-to-date.</li>
</ul>
<h4><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_std_select.html">StdSelect</a></h4>
<p><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_std_select.html">StdSelect</a></em> package contains the implementation of some <em>SelectMgr</em> classes and tools for creation of selection structures. For example,</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_std_select___b_rep_owner.html">StdSelect_BRepOwner</a></em> &ndash; defines an entity owner with a link to its topological shape and methods for highlighting;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_std_select___b_rep_selection_tool.html">StdSelect_BRepSelectionTool</a></em> &ndash; contains algorithms for splitting standard <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a> shapes into sensitive primitives;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_std_select___viewer_selector3d.html">StdSelect_ViewerSelector3d</a></em> &ndash; an example of <em>SelectMgr_ViewerSelecor</em> implementation, which is used in a default OCCT selection mechanism;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_std_select___face_filter.html">StdSelect_FaceFilter</a></em>, <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_std_select___edge_filter.html">StdSelect_EdgeFilter</a></em> &ndash; implementation of selection filters.</li>
</ul>
<h3><a class="anchor" id="occt_visu_2_2_4"></a>
Examples of usage</h3>
<p>The first code snippet illustrates the implementation of <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object.html#a1df0c8e9cd3b939e8c067b582c89d9e6">SelectMgr_SelectableObject::ComputeSelection()</a></em> method in a custom interactive object. The method is used for computation of user-defined selection modes.</p>
<p>Let us assume it is required to make a box selectable in two modes &ndash; the whole shape (mode 0) and each of its edges (mode 1).</p>
<p>To select the whole box, the application can create a sensitive primitive for each face of the interactive object. In this case, all primitives share the same owner &ndash; the box itself.</p>
<p>To select box's edge, the application must create one sensitive primitive per edge. Here all sensitive entities cannot share the owner since different geometric primitives must be highlighted as the result of selection procedure.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void InteractiveBox::ComputeSelection (const  Handle(SelectMgr_Selection)&amp; theSel,</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;                                       const Standard_Integer theMode)</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;{</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  switch (theMode)</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  {</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  case 0:   // creation of face sensitives for selection of the whole box</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  {</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    Handle(SelectMgr_EntityOwner) anOwnr = new SelectMgr_EntityOwner (this, 5);</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    for (Standard_Integer  aFaceIdx = 1; aFaceIdx &lt;= myNbFaces; aFaceIdx++)</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    {</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;      Select3D_TypeOfSensitivity aIsInteriorSensitivity = myIsInterior;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;      theSel-&gt;Add (new  Select3D_SensitiveFace (anOwnr,</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;                                                myFaces[aFaceIdx]-&gt;PointArray(),</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                                                aIsInteriorSensitivity));</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    }</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    break;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  }</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  case 1: // creation of edge sensitives for selection of box edges only</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  {</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    for (Standard_Integer anEdgeIdx = 1; anEdgeIdx &lt;= 12; anEdgeIdx++)</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      // 1 owner per edge, where 6 is a priority of the sensitive</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;      Handle(MySelection_EdgeOwner) anOwnr = new MySelection_EdgeOwner (this, anEdgeIdx, 6);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;      theSel-&gt;Add (new  Select3D_SensitiveSegment (anOwnr,</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                                                   FirstPnt[anEdgeIdx]),</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                                                   LastPnt[anEdgeIdx]));</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    }</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    break;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  }</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;}</div>
</div><!-- fragment --><p>The algorithms for creating selection structures store sensitive primitives in <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selection.html">SelectMgr_Selection</a></em> instance. Each <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selection.html">SelectMgr_Selection</a></em> sequence in the list of selections of the object must correspond to a particular selection mode.</p>
<p>To describe the decomposition of the object into selectable primitives, a set of ready-made sensitive entities is supplied in <em>Select3D</em> package. Custom sensitive primitives can be defined through inheritance from <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_basics___sensitive_entity.html">SelectBasics_SensitiveEntity</a></em>.</p>
<p>To make custom interactive objects selectable or customize selection modes of existing objects, the entity owners must be defined. They must inherit <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___entity_owner.html">SelectMgr_EntityOwner</a></em> interface.</p>
<p>Selection structures for any interactive object are created in <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object.html#a1df0c8e9cd3b939e8c067b582c89d9e6">SelectMgr_SelectableObject::ComputeSelection()</a></em> method.</p>
<p>The example below shows how computation of different selection modes of the topological shape can be done using standard OCCT mechanisms, implemented in <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_std_select___b_rep_selection_tool.html">StdSelect_BRepSelectionTool</a></em>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void MyInteractiveObject::ComputeSelection (const Handle(SelectMgr_Selection)&amp; theSelection,</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;                                            const Standard_Integer theMode)</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;{</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  switch (theMode)</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  {</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    case 0:</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;      StdSelect_BRepSelectionTool::Load (theSelection, this, myTopoDSShape, TopAbs_SHAPE);</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;      break;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    case 1:</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;      StdSelect_BRepSelectionTool::Load (theSelection, this, myTopoDSShape, TopAbs_VERTEX);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;      break;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    case 2:</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;      StdSelect_BRepSelectionTool::Load (theSelection, this, myTopoDSShape, TopAbs_EDGE);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;      break;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    case 3:</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      StdSelect_BRepSelectionTool::Load (theSelection, this, myTopoDSShape, TopAbs_WIRE);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;      break;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    case 4:</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      StdSelect_BRepSelectionTool::Load (theSelection, this, myTopoDSShape, TopAbs_FACE);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;      break;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  }</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;}</div>
</div><!-- fragment --><p>The <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_std_select___b_rep_selection_tool.html">StdSelect_BRepSelectionTool</a></em> class provides a high level API for computing sensitive entities of the given type (for example, face, vertex, edge, wire and others) using topological data from the given <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_topo_d_s___shape.html">TopoDS_Shape</a></em>.</p>
<p>The traditional way of highlighting selected entity owners adopted by Open CASCADE Technology assumes that each entity owner highlights itself on its own. This approach has two drawbacks:</p>
<ul>
<li>each entity owner has to maintain its own <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_prs3d___presentation.html">Prs3d_Presentation</a></em> object, that results in a large memory overhead for thousands of owners;</li>
<li>drawing selected owners one by one is not efficient from the OpenGL usage viewpoint.</li>
</ul>
<p>Therefore, to overcome these limitations, OCCT has an alternative way to implement the highlighting of a selected presentation. Using this approach, the interactive object itself will be responsible for the highlighting, not the entity owner.</p>
<p>On the basis of <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___entity_owner.html#a7520dbc8951dc791da2361b6d402f053">SelectMgr_EntityOwner::IsAutoHilight()</a></em> return value, <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___local_context.html">AIS_LocalContext</a></em> object either uses the traditional way of highlighting (in case if <em>IsAutoHilight()</em> returns true) or groups such owners according to their selectable objects and finally calls <em> <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object.html#a5255d420815700694320fbbc4733dbbe">SelectMgr_SelectableObject::HilightSelected()</a></em> or <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object.html#a06a4a7705ca8873779f5afb4e28f0458">SelectMgr_SelectableObject::ClearSelected()</a></em>, passing a group of owners as an argument.</p>
<p>Hence, an application can derive its own interactive object and redefine virtual methods <em>HilightSelected()</em>, <em>ClearSelected()</em> and <em>HilightOwnerWithColor()</em> from <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object.html">SelectMgr_SelectableObject</a></em>. <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object.html#ab687a3000ff28292b1a637eb825c8fbc">SelectMgr_SelectableObject::GetHilightPresentation</a></em> and <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object.html#a9555a2c6073aee13b8a91a67e8d30929">SelectMgr_SelectableObject::GetSelectPresentation</a></em> methods can be used to optimize filling of selection and highlight presentations according to the user's needs.</p>
<p>The <em>AIS_InteractiveContext::HighlightSelected()</em> method can be used for efficient redrawing of the selection presentation for a given interactive object from an application code.</p>
<p>After all the necessary sensitive entities are computed and packed in <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selection.html">SelectMgr_Selection</a></em> instance with the corresponding owners in a redefinition of <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object.html#a1df0c8e9cd3b939e8c067b582c89d9e6">SelectMgr_SelectableObject::ComputeSelection()</a></em> method, it is necessary to register the prepared selection in <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selection_manager.html">SelectMgr_SelectionManager</a></em> through the following steps:</p><ul>
<li>if there was no <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html">AIS_InteractiveContext</a></em> opened, create an interactive context and display the selectable object in it;</li>
<li>load the selectable object to the selection manager of the interactive context using <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a323e4c80099fd52d81e17a95db1d3f82">AIS_InteractiveContext::Load()</a></em> method. If the selection mode passed as a parameter to this method is not equal to -1, <em>ComputeSelection()</em> for this selection mode will be called;</li>
<li>activate or deactivate the defined selection mode using <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a42c02317741462be956be3b7f3d3976e">AIS_InteractiveContext::Activate()</a></em> or <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a781c9ff6e3d3c1c0b43f80d99c5a73de">AIS_InteractiveContext::Deactivate()</a></em> methods.</li>
</ul>
<p>After these steps, the selection manager of the created interactive context will contain the given object and its selection entities, and they will be involved in the detection procedure.</p>
<p>The code snippet below illustrates the above steps. It also contains the code to start the detection procedure and parse the results of selection.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// Suppose there is an instance of class InteractiveBox from the previous sample.</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;// It contains an implementation of method InteractiveBox::ComputeSelection() for selection</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;// modes 0 (whole box must be selected) and 1 (edge of the box must be selectable)</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Handle(InteractiveBox) aBox;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;// Assume there is a created interactive context</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;const Handle(AIS_InteractiveContext)&amp; aContext = GetContext();</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;// To prevent automatic activation of the default selection mode</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;aContext-&gt;SetAutoActivateSelection (Standard_False);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;aContext-&gt;Display (aBox);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;// Load a box to the selection manager without computation of any selection mode</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;aContext-&gt;Load (aBox, -1, Standard_True);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;// Activate edge selection</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;aContext-&gt;Activate (aBox, 1);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;// Run the detection mechanism for activated entities in the current mouse coordinates and</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;// in the current view. Detected owners will be highlighted with context highlight color</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;aContext-&gt;MoveTo (aXMousePos, aYMousePos, myView);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;// Select the detected owners</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;aContext-&gt;Select();</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;// Iterate through the selected owners</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;for (aContext-&gt;InitSelected(); aContext-&gt;MoreSelected() &amp;&amp; !aHasSelected; aContext-&gt;NextSelected())</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  Handle(AIS_InteractiveObject) anIO = aContext-&gt;SelectedInteractive();</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;// deactivate all selection modes for aBox1</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;aContext-&gt;Deactivate (aBox1);</div>
</div><!-- fragment --><p>It is also important to know, that there are 2 types of detection implemented for rectangular selection in OCCT:</p><ul>
<li><b>inclusive</b> detection. In this case the sensitive primitive is considered detected only when all its points are included in the area defined by the selection rectangle;</li>
<li><b>overlap</b> detection. In this case the sensitive primitive is considered detected when it is partially overlapped by the selection rectangle.</li>
</ul>
<p>The standard OCCT selection mechanism uses inclusion detection by default. To change this, use the following code:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// Assume there is a created interactive context </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;const Handle(AIS_InteractiveContext)&amp; aContext = GetContext();</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;// Retrieve the current viewer selector</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;const Handle(StdSelect_ViewerSelector3d)&amp; aMainSelector = aContext-&gt;MainSelector();</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;// Set the flag to allow overlap detection</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;aMainSelector-&gt;AllowOverlapDetection (Standard_True);</div>
</div><!-- fragment --><h1><a class="anchor" id="occt_visu_3"></a>
Application Interactive Services</h1>
<h2><a class="anchor" id="occt_visu_3_1"></a>
Introduction</h2>
<p>Application Interactive Services allow managing presentations and dynamic selection in a viewer in a simple and transparent manner.</p>
<p>The central entity for management of visualization and selections is the <b>Interactive Context</b>. It is connected to the main viewer (and if need be, the trash bin viewer). It has two operating modes: the Neutral Point and the local visualization and selection context.</p>
<p>The neutral point, which is the default mode, allows easily visualizing and selecting interactive objects loaded into the context.</p>
<p><b>Local Contexts</b> can be opened to prepare and use a temporary selection environment without disturbing the neutral point. It is possible to choose the interactive objects, which you want to act on, the selection modes, which you want to activate, and the temporary visualizations, which you will execute.</p>
<p>When the operation is finished, you close the current local context and return to the state in which you were before opening it (neutral point or previous local context).</p>
<p><b>Interactive Objects</b> are the entities, which are visualized and selected. You can use classes of standard interactive objects for which all necessary functions have already been programmed, or you can implement your own classes of interactive objects, by respecting a certain number of rules and conventions described below.</p>
<div class="image">
<img src="visualization_image016.png" alt="visualization_image016.png"/>
</div>
 <p>An Interactive Object is a "virtual" entity, which can be presented and selected. An Interactive Object can have a certain number of specific graphic attributes, such as visualization mode, color and material.</p>
<p>When an Interactive Object is visualized, the required graphic attributes are taken from its own <b>Drawer</b> if it has the required custom attributes or otherwise from the context drawer.</p>
<div class="image">
<img src="visualization_image017.png" alt="visualization_image017.png"/>
</div>
 <p>It can be necessary to filter the entities to be selected. Consequently there are <b>Filter</b> entities, which allow refining the dynamic detection context. Some of these filters can be used at the Neutral Point, others only in an open local context. It is possible to program custom filters and load them into the interactive context.</p>
<h2><a class="anchor" id="occt_visu_3_2"></a>
Interactive objects</h2>
<p>Entities which are visualized and selected in the <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a> viewer are objects. They connect the underlying reference geometry of a model to its graphic representation in <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a></em>. You can use the predefined OCCT classes of standard interactive objects, for which all necessary functions have already been programmed, or, if you are an advanced user, you can implement your own classes of interactive objects.</p>
<h3><a class="anchor" id="occt_visu_3_2_1"></a>
Presentations</h3>
<p>An interactive object can have as many presentations as its creator wants to give it.</p>
<p>3D presentations are managed by PresentationManager3D. As this is transparent in <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a>, the user does not have to worry about it.</p>
<p>A presentation is identified by an index and by the reference to the Presentation Manager which it depends on.</p>
<p>By convention, the default mode of representation for the Interactive Object has index 0.</p>
<div class="image">
<img src="visualization_image018.png" alt="visualization_image018.png"/>
</div>
 <p>Calculation of different presentations of an interactive object is done by the <em>Compute</em> functions inheriting from <em>PrsMgr_ PresentableObject::Compute</em> functions. They are automatically called by <em>PresentationManager</em> at a visualization or an update request.</p>
<p>If you are creating your own type of interactive object, you must implement the Compute function in one of the following ways:</p>
<h4>For 3D:</h4>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void PackageName_ClassName::Compute  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    (const  Handle(PrsMgr_PresentationManager3d)&amp; aPresentationManager,   </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;     const  Handle(Prs3d_Presentation)&amp; aPresentation,  </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;     const Standard_Integer aMode =  0);  </div>
</div><!-- fragment --><p>#### For hidden line removal (HLR) mode in 3D: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void PackageName_ClassName::Compute  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    (const  Handle(Prs3d_Projector)&amp; aProjector,  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;     const  Handle(Prs3d_Presentation)&amp; aPresentation);  </div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_3_2_2"></a>
Hidden Line Removal</h3>
<p>The view can have two states: the normal mode or the computed mode (Hidden Line Removal mode). When the latter is active, the view looks for all presentations displayed in the normal mode, which have been signalled as accepting HLR mode. An internal mechanism allows calling the interactive object's own <em>Compute</em>, that is projector function.</p>
<p>By convention, the Interactive Object accepts or rejects the representation of HLR mode. It is possible to make this declaration in one of two ways:</p>
<ul>
<li>Initially by using one of the values of the enumeration <em>PrsMgr_TypeOfPresentation</em>:<ul>
<li><em>PrsMgr_TOP_AllView</em>,</li>
<li><em>PrsMgr_TOP_ProjectorDependant</em></li>
</ul>
</li>
<li>Later by using the function <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_prs_mgr___presentable_object.html#a2a6017f13ea549d9710e7b6d96df1426">PrsMgr_PresentableObject::SetTypeOfPresentation</a></em></li>
</ul>
<p><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a></em> class is an example of an interactive object that supports HLR representation. It supports two types of the HLR algorithm:</p><ul>
<li>the polygonal algorithm based on the shape's triangulation;</li>
<li>the exact algorithm that works with the shape's real geometry.</li>
</ul>
<p>The type of the HLR algorithm is stored in <em>AIS_Drawer</em> of the shape. It is a value of the <em>Prs3d_TypeOfHLR</em> enumeration and can be set to:</p><ul>
<li><em>Prs3d_TOH_PolyAlgo</em> for a polygonal algorithm;</li>
<li><em>Prs3d_TOH_Algo</em> for an exact algorithm;</li>
<li><em>Prs3d_TOH_NotSet</em> if the type of algorithm is not set for the given interactive object instance.</li>
</ul>
<p>The type of the HLR algorithm used for <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a></em> can be changed by calling the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html#ab46e2e49a63cdc76b4c8526014868c40">AIS_Shape::SetTypeOfHLR()</a></em> method.</p>
<p>The current HLR algorithm type can be obtained using <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html#ae85efe2752ce89cb539f743083c747d7">AIS_Shape::TypeOfHLR()</a></em> method is to be used.</p>
<p>These methods get the value from the drawer of <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a></em>. If the HLR algorithm type in the <em>AIS_Drawer</em> is set to <em>Prs3d_TOH_NotSet</em>, the <em>AIS_Drawer</em> gets the value from the default drawer of <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html">AIS_InteractiveContext</a></em>.</p>
<p>So it is possible to change the default HLR algorithm used by all newly displayed interactive objects. The value of the HLR algorithm type stored in the context drawer can be <em>Prs3d_TOH_Algo</em> or <em>Prs3d_TOH_PolyAlgo</em>. The polygonal algorithm is the default one.</p>
<h3><a class="anchor" id="occt_visu_3_2_3"></a>
Presentation modes</h3>
<p>There are four types of interactive objects in <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a>:</p><ul>
<li>the "construction element" or Datum,</li>
<li>the Relation (dimensions and constraints)</li>
<li>the Object</li>
<li>the None type (when the object is of an unknown type).</li>
</ul>
<p>Inside these categories, additional characterization is available by means of a signature (an index.) By default, the interactive object has a NONE type and a signature of 0 (equivalent to NONE.) If you want to give a particular type and signature to your interactive object, you must redefine two virtual functions:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#a37b4231ae4e0faba64b18f5402cfd89b">AIS_InteractiveObject::Type</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#afee6476d648698e729e44ee3efd48aae">AIS_InteractiveObject::Signature</a></em>.</li>
</ul>
<p><b>Note</b> that some signatures are already used by "standard" objects provided in <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a> (see the <a class="el" href="occt_user_guides__visualization.html#occt_visu_3_5">List of Standard Interactive Object Classes</a>.</p>
<p>The interactive context can have a default mode of representation for the set of interactive objects. This mode may not be accepted by a given class of objects.</p>
<p>Consequently, to get information about this class it is necessary to use virtual function <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#a57f5162f79917a993cb8a38ac406ba3e">AIS_InteractiveObject::AcceptDisplayMode</a></em>.</p>
<h4>Display Mode</h4>
<p>The functions <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a08b9f39b0421810e4e18bdf6fb1df21d">AIS_InteractiveContext::SetDisplayMode</a></em> and <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a5bf76a7fd6685ec5870abfc4381b2403">AIS_InteractiveContext::UnsetDisplayMode</a></em> allow setting a custom display mode for an objects, which can be different from that proposed by the interactive context.</p>
<h4>Highlight Mode</h4>
<p>At dynamic detection, the presentation echoed by the Interactive Context, is by default the presentation already on the screen.</p>
<p>The functions <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#a2b89057184b5355ed831aaf9b31088e1">AIS_InteractiveObject::SetHilightMode</a></em> and <em>AIS_InteractiveObject::UnSetHilightMode</em> allow specifying the display mode used for highlighting (so called highlight mode), which is valid independently from the active representation of the object. It makes no difference whether this choice is temporary or definitive.</p>
<p>Note that the same presentation (and consequently the same highlight mode) is used for highlighting <em>detected</em> objects and for highlighting <em>selected</em> objects, the latter being drawn with a special <em>selection color</em> (refer to the section related to <em>Interactive Context</em> services).</p>
<p>For example, you want to systematically highlight the wireframe presentation of a shape - non regarding if it is visualized in wireframe presentation or with shading. Thus, you set the highlight mode to <em>0</em> in the constructor of the interactive object. Do not forget to implement this representation mode in the <em>Compute</em> functions.</p>
<h4>Infinite Status</h4>
<p>If you do not want an object to be affected by a <em>FitAll</em> view, you must declare it infinite; you can cancel its "infinite" status using <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#ac73cc622e355bb98107805b4fe634e57">AIS_InteractiveObject::SetInfiniteState</a></em> and <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#a1fa66ae7688346b0d0fc61ae64a670bf">AIS_InteractiveObject::IsInfinite</a></em> functions.</p>
<p>Let us take for example the class called <em>IShape</em> representing an interactive object :</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;myPk_IShape::myPK_IShape  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    (const TopoDS_Shape&amp; SH,  PrsMgr_TypeOfPresentation aType):  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    AIS_InteractiveObject(aType), myShape(SH), myDrwr(new AIS_Drawer())  {SetHilightMode(0);}   </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;void myPk_IShape::Compute  </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    (const Handle(PrsMgr_PresentationManager3d)  &amp; PM,  </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;     const Handle(Prs3d_Presentation)&amp; P,   </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;     const Standard_Integer TheMode) </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{ </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    switch (TheMode){  </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    case 0: </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    StdPrs_WFDeflectionShape::Add  (P,myShape,myDrwr);  //algo for  calculation of wireframe presentation break;  </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    case 1: </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    StdPrs_ShadedShape::Add  (P,myShape,myDrwr);   //algo for calculation of shading presentation.  </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    break; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    }  </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;}  </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;void myPk_IsShape::Compute  </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    (const  Handle(Prs3d_Projector)&amp; Prj,  </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    const  Handle(Prs3d_Presentation) P)  </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;{ </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    StdPrs_HLRPolyShape::Add(P,myShape,myDrwr); </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    //Hidden line mode calculation algorithm  </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;}  </div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_3_2_4"></a>
Selection</h3>
<p>An interactive object can have an indefinite number of selection modes, each representing a "decomposition" into sensitive primitives. Each primitive has an <em>owner</em> (<em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___entity_owner.html">SelectMgr_EntityOwner</a></em>) which allows identifying the exact interactive object or shape which has been detected (see <a class="el" href="occt_user_guides__visualization.html#occt_visu_2_2">Selection</a> chapter).</p>
<p>The set of sensitive primitives, which correspond to a given mode, is stocked in a <b>selection</b> (<em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selection.html">SelectMgr_Selection</a></em>).</p>
<p>Each selection mode is identified by an index. By convention, the default selection mode that allows us to grasp the interactive object in its entirety is mode <em>0</em>. However, it can be modified in the custom interactive objects using method <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object.html#a3faa6ab89d2afaaa7df519d069d1f4dd">SelectMgr_SelectableObject::setGlobalSelMode()</a></em>.</p>
<p>The calculation of selection primitives (or sensitive entities) is done by the intermediary of a virtual function, <em>ComputeSelection</em>. It should be implemented for each type of interactive object that is assumed to have different selection modes using the function <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object.html#a1df0c8e9cd3b939e8c067b582c89d9e6">AIS_ConnectedInteractive::ComputeSelection</a></em>.</p>
<p>A detailed explanation of the mechanism and the manner of implementing this function has been given in <a class="el" href="occt_user_guides__visualization.html#occt_visu_2_2">Selection</a> chapter.</p>
<p>There are some examples of selection mode calculation for the most widely used interactive object in OCCT &ndash; <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a></em> (selection by vertex, by edges, etc). To create new classes of interactive objects with the same selection behavior as <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a></em> &ndash; such as vertices and edges &ndash; you must redefine the virtual function <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#a37c55dd67208a4de4652e2dafa004990">AIS_InteractiveObject::AcceptShapeDecomposition</a></em>.</p>
<p>You can change the default selection mode index of a custom interactive object using the following functions:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object.html#a3faa6ab89d2afaaa7df519d069d1f4dd">AIS_InteractiveObject::setGlobalSelMode</a></em> sets global selection mode;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object.html#a9ea6b5fe0536992be32b170a410a00ec">AIS_InteractiveObject::GlobalSelectionMode</a></em> returns global selection mode of the object;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object.html#a8cbfdeef41bda7f2ad444e9fdc8cc977">AIS_InteractiveObject::GlobalSelOwner</a></em> returns an entity owner that corresponds to a global selection mode.</li>
</ul>
<p>You also can temporarily change the priority of some interactive objects for selection of the global mode to facilitate their graphic detection using the following functions:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#a3c1598627722be34c5905b1adf61f790">AIS_InteractiveObject::HasSelectionPriority</a></em> checks if there is a selection priority setting for the owner;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#a93f7df33dc7dca9b960faeb4c908535c">AIS_InteractiveObject::SelectionPriority</a></em> checks the current priority;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#aab79dacfeafe2f785e71ba1c0eb8b873">AIS_InteractiveObject::SetSelectionPriority</a></em> sets a priority;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#a2ac92383508ecd96b86345420249ecdb">AIS_InteractiveObject::UnsetSelectionPriority</a></em> unsets the priority.</li>
</ul>
<h3><a class="anchor" id="occt_visu_3_2_5"></a>
Graphic attributes</h3>
<p>Graphic attributes manager, or <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a> Drawer</em>, stores graphic attributes for specific interactive objects and for interactive objects controlled by interactive context.</p>
<p>Initially, all drawer attributes are filled out with the predefined values which will define the default 3D object appearance.</p>
<p>When an interactive object is visualized, the required graphic attributes are first taken from its own drawer if one exists, or from the context drawer if no specific drawer for that type of object exists.</p>
<p>Keep in mind the following points concerning graphic attributes:</p><ul>
<li>Each interactive object can have its own visualization attributes.</li>
<li>The set of graphic attributes of an interactive object is stocked in an <em>AIS_Drawer</em>, which is only a <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_prs3d___drawer.html">Prs3d_Drawer</a></em> with the possibility of a link to another drawer</li>
<li>By default, the interactive object takes the graphic attributes of the context in which it is visualized (visualization mode, deflection values for the calculation of presentations, number of isoparameters, color, type of line, material, etc.)</li>
<li>In the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html">AIS_InteractiveObject</a></em> abstract class, standard attributes including color, line thickness, material, and transparency have been privileged. Consequently, there is a certain number of virtual functions, which allow acting on these attributes. Each new class of interactive object can redefine these functions and change the behavior of the class.</li>
</ul>
<div class="image">
<img src="visualization_image019.png" alt="visualization_image019.png"/>
<div class="caption">
Figure 13. Redefinition of virtual functions for changes in AIS_Point</div></div>
 <div class="image">
<img src="visualization_image020.png" alt="visualization_image020.png"/>
<div class="caption">
Figure 14. Redefinition of virtual functions for changes in AIS_Shape.</div></div>
 The following virtual functions provide settings for color, width, material and transparency:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#a172fcd564af1644dac79819125da8e3c">AIS_InteractiveObject::UnsetColor</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#a26c50c505ea9b45e6d81b2c5bbd07535">AIS_InteractiveObject::SetWidth</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#a6645334271f53e0239dc1a9d98e064af">AIS_InteractiveObject::UnsetWidth</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#ab9fd753f70f80288320d6a27870cc3ec">AIS_InteractiveObject::SetMaterial</a> (const Graphic3d_NameOfPhysicalMaterial &amp; aName)</em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#ab9fd753f70f80288320d6a27870cc3ec">AIS_InteractiveObject::SetMaterial</a> (const <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___material_aspect.html">Graphic3d_MaterialAspect</a> &amp; aMat)</em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#a168e416dd0949ebf5b9d4f6c17fe02aa">AIS_InteractiveObject::UnsetMaterial</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#a201080a4986f9403b97c87df92364177">AIS_InteractiveObject::SetTransparency</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#a32a0a4fb40d446b9c4644208e83d7607">AIS_InteractiveObject::UnsetTransparency</a></em></li>
</ul>
<p>For other types of attribute, it is appropriate to change the Drawer of the object directly using:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___selectable_object.html#ae8efc94b9554ffbd65efbe07d54fb300">AIS_InteractiveObject::SetAttributes</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#ae2a17f4a73233e4418eaa4cf72db46d0">AIS_InteractiveObject::UnsetAttributes</a></em></li>
</ul>
<p>It is important to know which functions may imply the recalculation of presentations of the object.</p>
<p>If the presentation mode of an interactive object is to be updated, a flag from <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_prs_mgr___presentable_object.html">PrsMgr_PresentableObject</a></em> indicates this.</p>
<p>The mode can be updated using the functions <em>Display</em> and <em>Redisplay</em> in <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html">AIS_InteractiveContext</a></em>.</p>
<h3><a class="anchor" id="occt_visu_3_2_6"></a>
Complementary  Services</h3>
<p>When you use complementary services for interactive objects, pay special attention to the cases mentioned below.</p>
<h4>Change the location of an interactive object</h4>
<p>The following functions allow temporarily "moving" the representation and selection of Interactive Objects in a view without recalculation.</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a85da1a0b5c34f21cbb8b8ad64046179d">AIS_InteractiveContext::SetLocation</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a60065b9dbb4133a6308050e82fa09856">AIS_InteractiveContext::ResetLocation</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#ac74ffd7e6bbea0576b9d4428812a5321">AIS_InteractiveContext::HasLocation</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a167297cc6abe7a1b78ba4a3686fa0657">AIS_InteractiveContext::Location</a></em></li>
</ul>
<h4>Connect an interactive object to an applicative entity</h4>
<p>Each Interactive Object has functions that allow attributing it an <em>Owner</em> in form of a <em>Transient</em>.</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#a4383be51140f835890e4505d2bb03f50">AIS_InteractiveObject::SetOwner</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#a7262ea96d932cb9e9a25101785ebe640">AIS_InteractiveObject::HasOwner</a></em></li>
<li><em>AIS_InteractiveObject::Owner</em></li>
</ul>
<p>An interactive object can therefore be associated or not with an applicative entity, without affecting its behavior.</p>
<h4>Resolving coincident topology</h4>
<p>Due to the fact that the accuracy of three-dimensional graphics coordinates has a finite resolution the elements of topological objects can coincide producing the effect of "popping" some elements one over another.</p>
<p>To the problem when the elements of two or more Interactive Objects are coincident you can apply the polygon offset. It is a sort of graphics computational offset, or depth buffer offset, that allows you to arrange elements (by modifying their depth value) without changing their coordinates. The graphical elements that accept this kind of offsets are solid polygons or displayed as boundary lines and points. The polygons could be displayed as lines or points by setting the appropriate interior style.</p>
<p>The method <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html#aede01b8961416a8997587b5fc550048a">AIS_InteractiveObject::SetPolygonOffsets</a> (const Standard_Integer aMode, const Standard_Real aFactor, const Standard_Real aUnits)</em> allows setting up the polygon offsets.</p>
<p>The parameter <em>aMode</em> can contain various combinations of <em>Aspect_PolygonOffsetMode</em> enumeration elements:</p><ul>
<li><em>Aspect_POM_None</em></li>
<li><em>Aspect_POM_Off</em></li>
<li><em>Aspect_POM_Fill</em></li>
<li><em>Aspect_POM_Line</em></li>
<li><em>Aspect_POM_Point</em></li>
<li><em>Aspect_POM_All</em></li>
</ul>
<p>The combination of these elements defines the polygon display modes that will use the given offsets. You can switch off the polygon offsets by passing <em>Aspect_POM_Off</em>. Passing <em>Aspect_POM_None</em> allows changing the <em>aFactor</em> and <em>aUnits</em> values without changing the mode. If <em>aMode</em> is different from <em>Aspect_POM_Off</em>, the <em>aFactor</em> and <em>aUnits</em> arguments are used by the graphics renderer to calculate the depth offset value: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;offset  = aFactor * m + aUnits * r</div>
</div><!-- fragment --><p> where <em>m</em> is the maximum depth slope for the currently displayed polygons, r is the minimum depth resolution (implementation-specific).</p>
<p>Negative offset values move polygons closer to the viewer while positive values shift polygons away.</p>
<p><b>Warning</b></p>
<p>This method has a side effect &ndash; it creates its own shading aspect if not yet created, so it is better to set up the object shading aspect first.</p>
<p>You can use the following functions to obtain the current settings for polygon offsets: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void  AIS_InteractiveObject::PolygonOffsets</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;      (Standard_Integer &amp;aMode, </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;       Standard_Real &amp;aFactor, </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;       Standard_Real &amp;aUnits) </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Standard_Boolean AIS_InteractiveObject::HasPolygonOffsets() </div>
</div><!-- fragment --><p>The same operation could be performed for the interactive object known by the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html">AIS_InteractiveContext</a></em> with the following methods: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void  AIS_InteractiveContext::SetPolygonOffsets</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    (const Handle(AIS_InteractiveObject) &amp;anObj, </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;     const Standard_Integer aMode,  </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;     const Standard_Real aFactor, </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;     const Standard_Real aUnits) </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;void  AIS_InteractiveContext::PolygonOffsets</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    (const Handle(AIS_InteractiveObject) &amp;anObj, </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;     Standard_Integer &amp;aMode,  </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;     Standard_Real &amp;aFactor, </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;     Standard_Real &amp;aUnits) </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;Standard_Boolean      AIS_InteractiveContext::HasPolygonOffsets</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    (const Handle(AIS_InteractiveObject) &amp;anObj) </div>
</div><!-- fragment --><h2><a class="anchor" id="occt_visu_3_3"></a>
Interactive Context</h2>
<h3><a class="anchor" id="occt_visu_3_3_1"></a>
Rules</h3>
<p>The Interactive Context allows managing in a transparent way the graphic and <b>selectable</b> behavior of interactive objects in one or more viewers. Most functions which allow modifying the attributes of interactive objects, and which were presented in the preceding chapter, will be looked at again here.</p>
<p>There is one essential rule to follow: the modification of an interactive object, which is already known by the Context, must be done using Context functions. You can only directly call the functions available for an interactive object if it has not been loaded into an Interactive Context.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Handle (AIS_Shape) TheAISShape = new AIS_Shape (ashape);  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    myIntContext-&gt;Display(TheAISShape);  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    myIntContext-&gt;SetDisplayMode(TheAISShape ,1);  </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    myIntContext-&gt;SetColor(TheAISShape,Quantity_NOC_RED);  </div>
</div><!-- fragment --><p>You can also write</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Handle (AIS_Shape) TheAISShape = new AIS_Shape (ashape);  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    TheAISShape-&gt;SetColor(Quantity_NOC_RED);  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    TheAISShape-&gt;SetDisplayMode(1);  </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    myIntContext-&gt;Display(TheAISShape);  </div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_3_3_2"></a>
Groups of functions</h3>
<p><b>Neutral Point</b> and <b>Local Context</b> constitute the two operating modes or states of the <b>Interactive Context</b>, which is the central entity which pilots visualizations and selections.</p>
<p>The <b>Neutral Point</b>, which is the default mode, allows easily visualizing and selecting interactive objects, which have been loaded into the context. Opening <b>Local contexts</b> allows preparing and using a temporary selection environment without disturbing the neutral point.</p>
<p>A set of functions allows choosing the interactive objects which you want to act on, the selection modes which you want to activate, and the temporary visualizations which you will execute. When the operation is finished, you close the current local context and return to the state in which you were before opening it (neutral point or previous local context).</p>
<p>The Interactive Context is composed of many functions, which can be conveniently grouped according to the theme:</p><ul>
<li>management proper to the context;</li>
<li>management in the local context;</li>
<li>presentations and selection in open/closed context;</li>
<li>selection strictly speaking.</li>
</ul>
<p>Some functions can only be used in open Local Context; others in closed local context; others do not have the same behavior in one state as in the other.</p>
<h3><a class="anchor" id="occt_visu_3_3_3"></a>
Management of the Interactive Context</h3>
<p>The <b>Interactive Context</b> is made up of a <b>Principal Viewer</b> and, optionally, a trash bin or <b>Collector Viewer</b>.</p>
<p>An interactive object can have a certain number of specific graphic attributes, such as visualization mode, color, and material. Correspondingly, the interactive context has a set of graphic attributes, the <em>Drawer</em>, which is valid by default for the objects it controls.</p>
<p>When an interactive object is visualized, the required graphic attributes are first taken from the object's own <em>Drawer</em> if one exists, or from the context drawer for the others.</p>
<p>The following adjustable settings allow personalizing the behavior of presentations and selections:</p><ul>
<li>Default Drawer, containing all the color and line attributes which can be used by interactive objects, which do not have their own attributes.</li>
<li>Default Visualization Mode for interactive objects. By default: <em>mode 0</em> ;</li>
<li>Highlight color of entities detected by mouse movement. By default: <em>Quantity_NOC_CYAN1</em>;</li>
<li>Pre-selection color. By default: <em>Quantity_NOC_GREEN</em>;</li>
<li>Selection color (when you click on a detected object). By default: <em>Quantity_NOC_GRAY80</em>;</li>
<li>Sub-Intensity color. By default: <em>Quantity_NOC_GRAY40</em>.</li>
</ul>
<p>All of these settings can be modified by functions proper to the Context.</p>
<p>When you change a graphic attribute pertaining to the Context (visualization mode, for example), all interactive objects, which do not have the corresponding appropriate attribute, are updated.</p>
<p>Let us examine the case of two interactive objects: <em>obj1</em> and <em>obj2</em>:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;TheCtx-&gt;Display(obj1,Standard_False); // False = no viewer update </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;TheCtx-&gt;Display(obj2,Standard_True); // True = viewer update  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;TheCtx-&gt;SetDisplayMode(obj1,3,Standard_False); </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;TheCtx-&gt;SetDisplayMode(2); </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;// obj2 is visualised in mode 2 (if it accepts this mode) </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;// obj1 stays visualised in its mode 3.  </div>
</div><!-- fragment --><p><em>PresentationManager3D</em> and <em>Selector3D</em>, which manage the presentation and selection of present interactive objects, are associated to the main Viewer. The same is true of the optional Collector.</p>
<h2><a class="anchor" id="occt_visu_3_4"></a>
Local Context</h2>
<h3><a class="anchor" id="occt_visu_3_4_1"></a>
Rules and Conventions</h3>
<ul>
<li>Opening a local context allows preparing an environment for temporary presentations and selections, which will disappear once the local context is closed.</li>
<li>It is possible to open several local contexts, but only the last one will be active.</li>
<li>When you close a local context, the previous one, which is still on the stack, is activated again. If none is left, you return to Neutral Point.</li>
<li>Each local context has an index created when the context opens. You should close the local context, which you have opened.</li>
</ul>
<p>The interactive object, which is used the most by applications, is <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a></em>. Consequently, standard functions are available which allow you to easily prepare selection operations on the constituent elements of shapes (selection of vertices, edges, faces etc) in an open local context. The selection modes specific to "Shape" type objects are called <b><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_standard.html">Standard</a> Activation Mode</b>. These modes are only taken into account in open local context and only act on interactive objects which have redefined the virtual function <em>AcceptShapeDecomposition()</em> so that it returns <em>TRUE</em>.</p><ul>
<li>Objects, which are temporarily in a local context, are not recognized by other local contexts a priori. Only objects visualized in Neutral Point are recognized by all local contexts.</li>
<li>The state of a temporary interactive object in a local context can only be modified while another local context is open.</li>
</ul>
<p><b>Warning</b></p>
<p>The specific modes of selection only concern the interactive objects, which are present in the Main Viewer. In the Collector, you can only locate interactive objects, which answer positively to the positioned filters when a local context is open, however, they are never decomposed in standard mode.</p>
<h3><a class="anchor" id="occt_visu_3_4_2"></a>
Management of Local Context</h3>
<p>The local context can be opened using method <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#ade08e8d7a541e41f53f4802f605b408d">AIS_InteractiveContext::OpenLocalContext</a></em>. The following options are available:</p><ul>
<li><em>UseDisplayedObjects</em>: allows loading the interactive objects visualized at Neutral Point in the opened local context. If <em>FALSE</em>, the local context is empty after being opened. If <em>TRUE</em>, the objects at Neutral Point are modified by their default selection mode.</li>
<li><em>AllowShapeDecomposition</em>: <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a></em> allows or prevents decomposition in standard shape location mode of objects at Neutral Point, which are type-privileged (see <a class="el" href="occt_user_guides__visualization.html#occt_visu_3_2_4">Selection</a> chapter). This Flag is only taken into account when <em>UseDisplayedObjects</em> is <em>TRUE</em>.</li>
<li><em>AcceptEraseOfObjects</em>: authorizes other local contexts to erase the interactive objects present in this context. This option is rarely used. The last option has no current use.</li>
</ul>
<p>This function returns the index of the created local context. It should be kept and used when the context is closed.</p>
<p>To load objects visualized at Neutral Point into a local context or remove them from it use methods </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;AIS_InteractiveContext::UseDisplayedObjects  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;AIS_InteractiveContext::NotUseDisplayedObjects  </div>
</div><!-- fragment --><p> Closing Local Contexts is done by: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;AIS_InteractiveContext::CloseLocalContext  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;AIS_InteractiveContext::CloseAllContexts  </div>
</div><!-- fragment --><p><em>Warning</em> When the index is not specified in the first function, the current Context is closed. This option can be dangerous, as other Interactive Functions can open local contexts without necessarily warning the user. For greater security, you have to close the context with the index given on opening.</p>
<p>To get the index of the current context, use function <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a42cb711599b4e148ba71a4529b125547">AIS_InteractiveContext::IndexOfCurrentLocal</a></em>. It allows closing all open local contexts at one go. In this case, you find yourself directly at Neutral Point.</p>
<p>When you close a local context, all temporary interactive objects are deleted, all selection modes concerning the context are canceled, and all content filters are emptied.</p>
<h3><a class="anchor" id="occt_visu_3_4_3"></a>
Presentation in a Neutral Point</h3>
<p>You must distinguish between the <b>Neutral Point</b> and the <b>Open Local Context</b> states. Although the majority of visualization functions can be used in both situations, their behavior is different.</p>
<p>Neutral Point should be used to visualize the interactive objects, which represent and select an applicative entity. Visualization and Erasing orders are straightforward:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;AIS_InteractiveContext::Display  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    (const  Handle(AIS_InteractiveObject)&amp; anIobj, </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;     const  Standard_Boolean updateviewer=Standard_True);  </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;AIS_InteractiveContext::Display  </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    (const  Handle(AIS_InteractiveObject)&amp; anIobj,  </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;     const  Standard_Integer amode, </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;     const  Standard_Integer aSelectionMode, </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;     const  Standard_Boolean updateviewer = Standard_True,  </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;     const  Standard_Boolean allowdecomposition =  Standard_True);  </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  AIS_InteractiveContext::Erase  </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  AIS_InteractiveContext::EraseMode  </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  AIS_InteractiveContext::ClearPrs  </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  AIS_InteractiveContext::Redisplay  </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  AIS_InteractiveContext::Remove  </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  AIS_InteractiveContext::EraseAll  </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  AIS_InteractiveContext::Hilight  </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  AIS_InteractiveContext::HilightWithColor  </div>
</div><!-- fragment --><p>Bear in mind the following points:</p><ul>
<li>It is recommended to display and erase interactive objects when no local context is opened, and open a local context for local selection only.</li>
<li>The first <em>Display</em> function among the two ones available in <em>InteractiveContext</em> visualizes the object in its default mode (set with help of SetDisplayMode() method of InteractiveObject prior to Display() call), or in the default context mode, if applicable. If it has neither, the function displays it in 0 presentation mode. The object's default selection mode is automatically activated (0 mode by convention).</li>
<li>Activating the displayed object by default can be turned off with help of <em>SetAutoActivateSelection()</em> method. This might be efficient if you are not interested in selection immediately after displaying an object.</li>
<li>The second <em>Display</em> function should only be used in Neutral Point to visualize a supplementary mode for the object, which you can erase by <em>EraseMode (...)</em>. You activate the selection mode. This is passed as an argument. By convention, if you do not want to activate a selection mode, you must set the <em>SelectionMode</em> argument to -1. This function is especially interesting in open local context, as we will see below.</li>
<li>In Neutral Point, it is not advisable to activate other selection modes than the default selection one. It is preferable to open a local context in order to activate particular selection modes.</li>
<li>When you call <em>Erase(Interactive object)</em> function, the <em>PutIncollector</em> argument, which is <em>FALSE</em> by default, allows you to visualize the object directly in the Collector and makes it selectable (by activation of 0 mode). You can nonetheless block its passage through the Collector by changing the value of this option. In this case, the object is present in the Interactive Context, but is not seen anywhere.</li>
<li><em>Erase()</em> with <em>putInCollector = Standard_True</em> might be slow as it recomputes the object presentation in the Collector. Set <em>putInCollector</em> to <em>Standard_False</em> if you simply want to hide the object's presentation temporarily.</li>
<li>Visualization attributes and graphic behavior can be modified through a set of functions similar to those for the interactive object (color, thickness of line, material, transparency, locations, etc.) The context then manages immediate and deferred updates.</li>
<li>Call <em>Remove()</em> method of <em>InteractiveContext</em> as soon as the interactive object is no longer needed and you want to destroy it.. Otherwise, references to <em>InteractiveObject</em> are kept by <em>InteractiveContext</em>, and the <em>Object</em> is not destroyed, which results in memory leaks. In general, if the presentation of an interactive object can be computed quickly, it is recommended to <em>Remove()</em> it instead of using <em>Erase()</em> method.</li>
</ul>
<h3><a class="anchor" id="occt_visu_3_4_4"></a>
Presentation in the Local Context</h3>
<p>In open local context, the <em>Display</em> functions presented above can be as well.</p>
<p><b>WARNING</b></p>
<p>The function <em>AIS_InteractiveObject::Display</em> automatically activates the object's default selection mode. When you only want to visualize an Interactive Object in open Context, you must call the function <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a4ccc4b3d53a43baf78f448280293cd5a">AIS_InteractiveContext::Display</a></em>.</p>
<p>You can activate or deactivate specific selection modes in the local open context in several different ways: Use the Display functions with the appropriate modes.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;AIS_InteractiveContext::ActivateStandardMode</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;//can be used only if a  Local Context is opened.   </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;AIS_InteractiveContext::DeactivateStandardMode  </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;AIS_InteractiveContext::ActivatedStandardModes  </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;AIS_InteractiveContext::SetShapeDecomposition  </div>
</div><!-- fragment --><p>This activates the corresponding selection mode for all objects in Local Context, which accept decomposition into sub-shapes. Every new Object which has been loaded into the interactive context and which meets the decomposition criteria is automatically activated according to these modes.</p>
<p><b>WARNING</b></p>
<p>If you have opened a local context by loading an object with the default options <em>(AllowShapeDecomposition = Standard_True)</em>, all objects of the "Shape" type are also activated with the same modes. You can change the state of these "Standard" objects by using <em>SetShapeDecomposition(Status)</em>.</p>
<p>Load an interactive object by the function <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a323e4c80099fd52d81e17a95db1d3f82">AIS_InteractiveContext::Load</a></em>.</p>
<p>This function allows loading an Interactive Object whether it is visualized or not with a given selection mode, and/or with the necessary decomposition option. If <em>AllowDecomp=TRUE</em> and obviously, if the interactive object is of the "Shape" type, these "standard" selection modes will be automatically activated as a function of the modes present in the Local Context.</p>
<p>Use <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a42c02317741462be956be3b7f3d3976e">AIS_InteractiveContext::Activate</a></em> and <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a781c9ff6e3d3c1c0b43f80d99c5a73de">AIS_InteractiveContext::Deactivate</a></em> to directly activate/deactivate selection modes on an object.</p>
<h3><a class="anchor" id="occt_visu_3_4_5"></a>
Filters</h3>
<p>To define an environment of dynamic detection, you can use standard filter classes or create your own. A filter questions the owner of the sensitive primitive in local context to determine if it has the desired qualities. If it answers positively, it is kept. If not, it is rejected.</p>
<p>The root class of objects is <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___filter.html">SelectMgr_Filter</a></em>. The principle behind it is straightforward: a filter tests to see whether the owners <em>(<a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_select_mgr___entity_owner.html">SelectMgr_EntityOwner</a>)</em> detected in mouse position by the Local context selector answer <em>OK</em>. If so, it is kept, otherwise it is rejected.</p>
<p>You can create a custom class of filter objects by implementing the deferred function <em>IsOk()</em>:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;class MyFilter : public SelectMgr_Filter { };  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;virtual Standard_Boolean MyFilter::IsOk  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    (const Handle(SelectMgr_EntityOwner)&amp;  anObj) const = 0; </div>
</div><!-- fragment --><p>In <em>SelectMgr</em>, there are also Composition filters (AND Filters, OR Filters), which allow combining several filters. In InteractiveContext , all filters that you add are stocked in an OR filter (which answers <em>OK</em> if at least one filter answers <em>OK</em>).</p>
<p>There are <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_standard.html">Standard</a> filters, which have already been implemented in several packages:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_std_select___edge_filter.html">StdSelect_EdgeFilter</a></em> &ndash; for edges, such as lines and circles;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_std_select___face_filter.html">StdSelect_FaceFilter</a></em> &ndash; for faces, such as planes, cylinders and spheres;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_std_select___shape_type_filter.html">StdSelect_ShapeTypeFilter</a></em> &ndash; for shape types, such as compounds, solids, shells and wires;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___type_filter.html">AIS_TypeFilter</a></em> &ndash; for types of interactive objects;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___signature_filter.html">AIS_SignatureFilter</a></em> &ndash; for types and signatures of interactive objects;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___attribute_filter.html">AIS_AttributeFilter</a></em> &ndash; for attributes of Interactive Objects, such as color and width.</li>
</ul>
<p>As there are specific behaviors on shapes, each new <em>Filter</em> class must, if necessary, redefine <em>AIS_LocalContext::ActsOn</em> function, which informs the Local Context if it acts on specific types of sub-shapes. By default, this function answers <em>FALSE</em>.</p>
<p><b>WARNING</b></p>
<p>Only type filters are activated in Neutral Point to make it possible to identify a specific type of visualized object. For filters to come into play, one or more object selection modes must be activated.</p>
<p>There are several functions to manipulate filters:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a4e428c18154ff233d8ee355f63124f5d">AIS_InteractiveContext::AddFilter</a></em> adds a filter passed as an argument.</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a344361c174b6a8c504a34158e19a062e">AIS_InteractiveContext::RemoveFilter</a></em> removes a filter passed as an argument.</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a539fbd050799a5fac5f9ee4c7fe8e543">AIS_InteractiveContext::RemoveFilters</a></em> removes all present filters.</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#ae4712e824bdb456007dfa325529adbb0">AIS_InteractiveContext::Filters</a></em> gets the list of filters active in a local context.</li>
</ul>
<h4>Example </h4>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;myContext-&gt;OpenLocalContext(Standard_False);  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;// no object in neutral point is  loaded  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;myContext-&gt;ActivateStandardMode(TopAbs_Face);  </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;//activates decomposition of  shapes into faces.  </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Handle (AIS_Shape) myAIShape = new AIS_Shape (  ATopoShape);  </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;myContext-&gt;Display(myAIShape,1,-1,Standard_True,Standard_True);  </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;//shading visualization mode,  no specific mode, authorization for decomposition into sub-shapes. At this  Stage, myAIShape is decomposed into faces...  </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;Handle(StdSelect_FaceFilter) Fil1= new  </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    StdSelect_FaceFilter(StdSelect_Revol);   </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;Handle(StdSelect_FaceFilter) Fil2= new </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;      StdSelect_FaceFilter(StdSelect_Plane);  </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;myContext-&gt;AddFilter(Fil1);   </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;myContext-&gt;AddFilter(Fil2);  </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;//only faces of revolution or  planar faces will be selected </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;myContext-&gt;MoveTo( xpix,ypix,Vue);  </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;// detects the mouse position  </div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_3_4_6"></a>
Selection in the Local Context</h3>
<p>Dynamic detection and selection are put into effect in a straightforward way. There are only a few conventions and functions to be familiar with. The functions are the same in neutral point and in open local context:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a69067d43fa3ccdab1c77cd499415889b">AIS_InteractiveContext::MoveTo</a></em> &ndash; passes mouse position to Interactive Context selectors</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#ac1f06ab9cbb730145ad7f633a9dc0bd3">AIS_InteractiveContext::Select</a></em> &ndash; stocks what has been detected on the last <em>MoveTo</em>. Replaces the previously selected object. Empties the stack if nothing has been detected at the last move</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a850af8d819e6d39c67b4f01ca742db5e">AIS_InteractiveContext::ShiftSelect</a></em> &ndash; if the object detected at the last move was not already selected, it is added to the list of the selected objects. If not, it is withdrawn. Nothing happens if you click on an empty area.</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#ac1f06ab9cbb730145ad7f633a9dc0bd3">AIS_InteractiveContext::Select</a></em> &ndash; selects everything found in the surrounding area.</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a850af8d819e6d39c67b4f01ca742db5e">AIS_InteractiveContext::ShiftSelect</a></em> &ndash; selects what was not previously in the list of selected, deselects those already present.</li>
</ul>
<p>Highlighting of detected and selected entities is automatically managed by the Interactive Context, whether you are in neutral point or Local Context. The Highlight colors are those dealt with above. You can nonetheless disconnect this automatic mode if you want to manage this part yourself : </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;AIS_InteractiveContext::SetAutomaticHilight  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;AIS_InteractiveContext::AutomaticHilight  </div>
</div><!-- fragment --><p>If there is no open local context, the objects selected are called <b>current objects</b>. If there is a local context, they are called <b>selected objects</b>. Iterators allow entities to be recovered in either case. A set of functions allows manipulating the objects, which have been placed in these different lists.</p>
<p><b>WARNING</b></p>
<p>When a Local Context is open, you can select entities other than interactive objects (vertices, edges etc.) from decompositions in standard modes, or from activation in specific modes on specific interactive objects. Only interactive objects are stocked in the list of selected objects.</p>
<p>You can question the Interactive context by moving the mouse. The following functions can be used:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#aae1a400d891788a65606fd3e697024fb">AIS_InteractiveContext::HasDetected</a></em> informs if something has been detected;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#adc7ac9bb3fe9ccc494f83a3a63664e8a">AIS_InteractiveContext::HasDetectedShape</a></em> informs if it is a shape;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#ab2eddbeeb61c51345e8ae4fea642b681">AIS_InteractiveContext::DetectedShape</a></em> gets the shape if the detected entity is an object;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#ab213fa007654da360723130d6c6d40b0">AIS_InteractiveContext::DetectedInteractive</a></em> gets the interactive object if the detected entity is an object.</li>
</ul>
<p>After using the <em>Select</em> and <em>ShiftSelect</em> functions in Neutral Point, you can explore the list of selections, referred to as current objects in this context. The following functions can be used:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#ad219dec5411c73e8f84d1cd179b00606">AIS_InteractiveContext::InitCurrent</a></em> initiates a scan of this list;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#ae85c87c9de1030d717580e44cd895501">AIS_InteractiveContext::MoreCurrent</a></em> extends the scan;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a40979cb82caebc58c7673f08ac525a90">AIS_InteractiveContext::NextCurrent</a></em> resumes the scan;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#aa8f92a576cb27a536b7a5d89fc637404">AIS_InteractiveContext::Current</a></em> gets the name of the current object detected in the scan;</li>
<li><em>AIS_InteractiveContext::FirstCurrentObject</em> gets the first current interactive object;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#aa96312441f515df77838c316e4524707">AIS_InteractiveContext::HilightCurrents</a></em> highlights current objects;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a9ec721b5e760b0ace7381787c6672a82">AIS_InteractiveContext::UnhilightCurrents</a></em> removes highlight from current objects;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a36ad5f5ae70a02dcfccb8757941a8049">AIS_InteractiveContext::ClearCurrents</a></em> empties the list of current objects in order to update it;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a5f8e17c98673cbc8ed633f028678ec56">AIS_InteractiveContext::IsCurrent</a></em> finds the current object.</li>
</ul>
<p>In the Local Context, you can explore the list of selected objects available. The following functions can be used:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#afffabfadddd46d2b00a8339d9835af1a">AIS_InteractiveContext::InitSelected</a></em> initiates the list of objects;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#aa58bd0cc8f96099bf207038dc22bb8ea">AIS_InteractiveContext::MoreSelected</a></em> extends the list of objects;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a0de665cf47ace4d86b49012dc9126fb6">AIS_InteractiveContext::NextSelected</a></em> resumes a scan;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a8f1a84cddc7428efefd5264dd9125ebd">AIS_InteractiveContext::SelectedShape</a></em> gets the name of the selected object;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a76a11b5cb61330603f8b6115211546ca">AIS_InteractiveContext::HasSelectedShape</a></em> checks if the selected shape is obtained;</li>
<li><em>AIS_InteractiveContext::Interactive</em> gets the picked interactive object;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a87dc663d5a833bdd8d3eebf870183bc7">AIS_InteractiveContext::HasApplicative</a></em> checks if the applicative object has an owner from Interactive attributed to it;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a724db641e23d567ed8636e70a38ebe7a">AIS_InteractiveContext::Applicative</a></em> gets the owner of the detected applicative entity;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a6c5063caaa77c8828eeec8ff762d0fa6">AIS_InteractiveContext::IsSelected</a></em> gets the name of the selected object.</li>
</ul>
<h4>Example </h4>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;myAISCtx-&gt;InitSelected();  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;while (myAISCtx-&gt;MoreSelected())  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    { </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    if  (myAISCtx-&gt;HasSelectedShape) </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        { </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        TopoDS_Shape  ashape = myAISCtx-&gt;SelectedShape(); </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;            // to be able  to use the picked shape </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;                        }  </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        else  </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;        { </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;        Handle_AIS_InteractiveObject  anyobj = myAISCtx-&gt;Interactive(); </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        // to be able to use the picked interactive object  </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;        }  </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;myAISCtx-&gt;NextSelected();  </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;}     </div>
</div><!-- fragment --><p>You have to ask whether you have selected a shape or an interactive object before you can recover the entity in the Local Context or in the iteration loop. If you have selected a Shape from <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_topo_d_s.html">TopoDS</a></em> on decomposition in standard mode, the <em>Interactive()</em> function returns the interactive object, which provided the selected shape. Other functions allow you to manipulate the content of Selected or Current Objects:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a9317c492652b36723aa51d3571a57c8c">AIS_InteractiveContext::EraseSelected</a></em> erases the selected objects;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a539a1f85e1dc1ada7ad91e7cfe45ccf3">AIS_InteractiveContext::DisplaySelected</a></em> displays them;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a1d4e0408670f54a1958281576e341ecc">AIS_InteractiveContext::SetSelected</a></em> puts the objects in the list of selections;</li>
<li><em>AIS_InteractiveContext::SetSelectedCurrent</em> takes the list of selected objects from a local context and puts it into the list of current objects in Neutral Point;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#abcbff3a447773ac1c282284548119508">AIS_InteractiveContext::AddOrRemoveSelected</a></em> adds or removes an object from the list of selected entities;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a24fb01bd61cc5ac7194473d6b264cd2c">AIS_InteractiveContext::HilightSelected</a></em> highlights the selected object;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#ae55acefc983046ebb09c6f04879acec6">AIS_InteractiveContext::UnhilightSelected</a></em> removes highlighting from the selected object;</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a5212f1268afcab8a2f3d8325549fce6f">AIS_InteractiveContext::ClearSelected</a></em> empties the list of selected objects.</li>
</ul>
<p>You can highlight and remove highlighting from a current object, and empty the list of current objects using the following functions: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;AIS_InteractiveContext::HilightCurrents  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;AIS_InteractiveContext::UnhilightCurrents  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;AIS_InteractiveContext::ClearCurrents  </div>
</div><!-- fragment --><p> When you are in an open Local Context, you may need to keep "temporary" interactive objects. This is possible using the following functions:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#a54fb80ec96513240292f4d7330a73648">AIS_InteractiveContext::KeepTemporary</a></em> transfers the characteristics of the interactive object seen in its local context (visualization mode, etc.) to the neutral point. When the local context is closed, the object does not disappear.</li>
<li><em>AIS_InteractiveContext::SetSelectedCurrent</em> allows the selected object to become the current object when you close the local context.</li>
</ul>
<p>You can also want to use function <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_context.html#aa1e02b8af5ccaba7c8924cdb7e473f54">AIS_InteractiveContext::ClearLocalContext</a></em> to modify in a general way the state of the local context before continuing a selection (emptying objects, removing filters, standard activation modes).</p>
<h3><a class="anchor" id="occt_visu_3_4_7"></a>
Recommendations</h3>
<p>The possibilities of use for local contexts are numerous depending on the type of operation that you want to perform:</p><ul>
<li>working on all visualized interactive objects,</li>
<li>working on only a few objects,</li>
<li>working on a single object.</li>
</ul>
<p>When you want to work on one type of entity, you should open a local context with the option <em>UseDisplayedObjects</em> set to FALSE. Some functions which allow you to recover the visualized interactive objects, which have a given Type, and Signature from the "Neutral Point" are:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;AIS_InteractiveContext::DisplayedObjects (AIS_ListOfInteractive&amp;  aListOfIO) const;  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;AIS_InteractiveContext::DisplayedObjects (const AIS_KindOfInteractive  WhichKind, const Standard_Integer  WhichSignature;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;AIS_ListOfInteractive&amp;  aListOfIO) const;  </div>
</div><!-- fragment --><p>At this stage, you only have to load the functions <em>Load, Activate,</em> and so on.</p>
<p>When you open a Local Context with default options, you must keep the following points in mind:</p><ul>
<li>The Interactive Objects visualized at Neutral Point are activated with their default selection mode. You must deactivate those, which you do not want to use.</li>
<li>The Shape Type Interactive Objects are automatically decomposed into sub-shapes when standard activation modes are launched.</li>
<li>The "temporary" Interactive Objects present in the Local Contexts are not automatically taken into account. You have to load them manually if you want to use them.</li>
</ul>
<p>The stages could be the following:</p><ol type="1">
<li>Open a Local Context with the right options;</li>
<li>Load/Visualize the required complementary objects with the desired activation modes.</li>
<li>Activate <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_standard.html">Standard</a> modes if necessary</li>
<li>Create its filters and add them to the Local Context</li>
<li>Detect/Select/recover the desired entities</li>
<li>Close the Local Context with the adequate index.</li>
</ol>
<p>It is useful to create an <b>interactive editor</b>, to which you pass the Interactive Context. This allow setting up different contexts of selection/presentation according to the operation, which you want to perform.</p>
<p>Let us assume that you have visualized several types of interactive objects: <em>AIS_Points</em>, <em>AIS_Axes</em>, <em>AIS_Trihedrons</em>, and <em>AIS_Shapes</em>.</p>
<p>For your applicative function, you need an axis to create a revolved object. You could obtain this axis by identifying:</p><ul>
<li>an axis which is already visualized,</li>
<li>2 points,</li>
<li>a rectilinear edge on the shapes which are present,</li>
<li>a cylindrical face on the shapes (You will take the axis of this face)</li>
</ul>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;myIHMEditor::myIHMEditor  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    (const  Handle(AIS_InteractiveContext)&amp; Ctx, </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;     ....) : </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;     myCtx(Ctx),  </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    ...  </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;{ </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;} </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;myIHMEditor::PrepareContext() </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;{ </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;myIndex =myCtx-&gt;OpenLocalContext();  </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;//the filters  </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;Handle(AIS_SignatureFilter) F1 = new  AIS_SignatureFilter(AIS_KOI_Datum,AIS_SD_Point);   </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;//filter on the points  </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;Handle(AIS_SignatureFilter) F2 = new AIS_SignatureFilter(AIS_KOI_Datum,AIS_SD_Axis);   </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;//filters on the axes.  </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;Handle(StdSelect_FaceFilter) F3 = new StdSelect_FaceFilter(AIS_Cylinder);   </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;//cylindrical face filters  </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;//... </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;// activation of standard modes  on the shapes..  </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;myCtx-&gt;ActivateStandardMode(TopAbs_FACE); </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;myCtx-&gt;ActivateStandardMode(TopAbs_VERTEX); </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;myCTX-&gt;Add(F1); </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;myCTX-&gt;Add(F2); </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;myCTX-&gt;Add(F3);  </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;// at  this point, you can call the selection/detection function  </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;} </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;void myIHMEditor::MoveTo(xpix,ypix,Vue) </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{  myCTX-&gt;MoveTo(xpix,ypix,vue);  </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;// the highlight of what is  detected is automatic.  </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;}      </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;Standard_Boolean myIHMEditor::Select()  </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;// returns true if you should  continue the selection      </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        myCTX-&gt;Select();   </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        myCTX-&gt;InitSelected();  </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        if(myCTX-&gt;MoreSelected()) </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;         {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;         if(myCTX-&gt;HasSelectedShape())     </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        { const  TopoDS_Shape&amp; sh = myCTX-&gt;SelectedShape(); </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        if(  vertex){  </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            if(myFirstV...)   </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            {  </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            //if it is the  first vertex, you stock it, then you deactivate the faces and only keep the  filter on the points: </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            mypoint1 =  ....; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            myCtx-&gt;RemoveFilters(); </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            myCTX-&gt;DeactivateStandardMode(TopAbs_FACE);   </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            myCtx-&gt;Add(F1);   </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            // the filter  on the AIS_Points  </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            myFirstV = Standard_False;  </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            return Standard_True;  </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;             }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            else</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;             { </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            mypoint2 =...;  </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            //  construction of the axis return Standard_False;  </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            } </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;         } </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;         else  </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          {  </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        //it is a  cylindrical face : you recover the axis; visualize it; and stock it.  </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        return  Standard_False;  </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        }  </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;          }  </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        // it is not  a shape but is no doubt a point.  </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        else  </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        {  </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        Handle(AIS_InteractiveObject)   </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        SelObj =  myCTX-&gt;SelectedInteractive(); </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        if(SelObj-&gt;Type()==AIS_KOI_Datum)   </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        { </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            if(SelObj-&gt;Signature()==1)   </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            { </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                if  (firstPoint) </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                { </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                mypoint1  =...  </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                return  Standard_True;  </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                } </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                else </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                {  </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                mypoint2 =  ...;  </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                //construction  of the axis, visualization, stocking  </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                return  Standard_False;  </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        } </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        } </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        else  </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        {  </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        // you have  selected an axis; stock the axis  </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        return  Standard_False; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        } </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        } </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        } </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        } </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        }  </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;void myIHMEditor::Terminate()</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;myCtx-&gt;CloseLocalContext(myIndex); </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;...</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div>
</div><!-- fragment --><h2><a class="anchor" id="occt_visu_3_5"></a>
Standard Interactive Object Classes</h2>
<p>Interactive Objects are selectable and viewable objects connecting graphic representation and the underlying reference geometry.</p>
<p>They are divided into four types:</p><ul>
<li>the <b>Datum</b> &ndash; a construction geometric element;</li>
<li>the <b>Relation</b> &ndash; a constraint on the interactive shape and the corresponding reference geometry;</li>
<li>the <b>Object</b> &ndash; a topological shape or connection between shapes;</li>
<li><b>None</b> &ndash; a token, that instead of eliminating the object, tells the application to look further until it finds an acceptable object definition in its generation.</li>
</ul>
<p>Inside these categories, there is a possibility of additional characterization by means of a signature. The signature provides an index to the further characterization. By default, the <b>Interactive Object</b> has a <em>None</em> type and a signature of 0 (equivalent to <em>None</em>). If you want to give a particular type and signature to your interactive object, you must redefine the two virtual methods: <em>Type</em> and <em>Signature</em>.</p>
<h3><a class="anchor" id="occt_visu_3_5_1"></a>
Datum</h3>
<p>The <b>Datum</b> groups together the construction elements such as lines, circles, points, trihedrons, plane trihedrons, planes and axes.</p>
<p><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___point.html">AIS_Point</a>, <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___axis.html">AIS_Axis</a>, <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___line.html">AIS_Line</a>, <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___circle.html">AIS_Circle</a>, <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___plane.html">AIS_Plane</a></em> and <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___trihedron.html">AIS_Trihedron</a></em> have four selection modes:</p><ul>
<li>mode 0 : selection of a trihedron;</li>
<li>mode 1 : selection of the origin of the trihedron;</li>
<li>mode 2 : selection of the axes;</li>
<li>mode 3 : selection of the planes XOY, YOZ, XOZ.</li>
</ul>
<p>when you activate one of modes: 1 2 3 4, you pick <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a> objects of type:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___point.html">AIS_Point</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___axis.html">AIS_Axis</a></em> (and information on the type of axis)</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___plane.html">AIS_Plane</a></em> (and information on the type of plane).</li>
</ul>
<p><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___plane_trihedron.html">AIS_PlaneTrihedron</a></em> offers three selection modes:</p><ul>
<li>mode 0 : selection of the whole trihedron;</li>
<li>mode 1 : selection of the origin of the trihedron;</li>
<li>mode 2 : selection of the axes &ndash; same remarks as for the Trihedron.</li>
</ul>
<p>For the presentation of planes and trihedra, the default unit of length is millimeter, and the default value for the representation of axes is 100. If you modify these dimensions, you must temporarily recover the object <b>Drawer</b>. From it, take the <em>Aspects</em> in which the values for length are stored (<em>PlaneAspect</em> for the plane, <em>FirstAxisAspect</em> for trihedra), and change these values inside these Aspects. Finally, recalculate the presentation.</p>
<h3><a class="anchor" id="occt_visu_3_5_2"></a>
Object</h3>
<p>The <b>Object</b> type includes topological shapes, and connections between shapes.</p>
<p><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a></em> has three visualization modes :</p><ul>
<li>mode 0 : Line (default mode)</li>
<li>mode 1 : Shading (depending on the type of shape)</li>
<li>mode 2 : Bounding Box</li>
</ul>
<p>And at maximum seven selection modes, depending on the shape complexity:</p><ul>
<li>mode 0 : selection of the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a></em>;</li>
<li>mode 1 : selection of the vertices;</li>
<li>mode 2 : selection of the edges;</li>
<li>mode 3 : selection of the wires;</li>
<li>mode 4 : selection of the faces;</li>
<li>mode 5 : selection of the shells;</li>
<li>mode 6 : selection of the constituent solids.</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___triangulation.html">AIS_Triangulation</a></em> is a simple interactive object for displaying triangular mesh contained in <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_poly___triangulation.html">Poly_Triangulation</a></em> container.</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___connected_interactive.html">AIS_ConnectedInteractive</a></em> is an Interactive Object connecting to another interactive object reference, and located elsewhere in the viewer makes it possible not to calculate presentation and selection, but to deduce them from your object reference.</li>
<li><em>AIS_ConnectedShape</em> is an object connected to interactive objects having a shape; this class has the same decompositions as <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a></em>. Furthermore, it allows a presentation of hidden parts, which are calculated automatically from the shape of its reference.</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___multiple_connected_interactive.html">AIS_MultipleConnectedInteractive</a></em> is an object connected to a list of interactive objects (which can also be Connected objects. It does not require memory hungry calculations of presentation)</li>
<li><em>AIS_MultipleConnectedShape</em> is an interactive Object connected to a list of interactive objects having a Shape <em>(<a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a>, AIS_ConnectedShape, AIS_MultipleConnectedShape)</em>. The presentation of hidden parts is calculated automatically.</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___textured_shape.html">AIS_TexturedShape</a></em> is an Interactive Object that supports texture mapping. It is constructed as a usual <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a>, but has additional methods that allow to map a texture on it.</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___mesh.html">MeshVS_Mesh</a></em> is an Interactive Object that represents meshes, it has a data source that provides geometrical information (nodes, elements) and can be built up from the source data with a custom presentation builder.</li>
</ul>
<p>The class <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___colored_shape.html">AIS_ColoredShape</a></em> allows using custom colors and line widths for <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_topo_d_s___shape.html">TopoDS_Shape</a></em> objects and their sub-shapes.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;AIS_ColoredShape aColoredShape = new AIS_ColoredShape (theShape);</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;// setup color of entire shape</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;aColoredShape-&gt;SetColor (Quantity_Color (Quantity_NOC_RED));</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;// setup line width of entire shape</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;aColoredShape-&gt;SetWidth (1.0);</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;// set transparency value</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;aColoredShape-&gt;SetTransparency (0.5);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;// customize color of specified sub-shape</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;aColoredShape-&gt;SetCustomColor (theSubShape, Quantity_Color (Quantity_NOC_BLUE1));</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;// customize line width of specified sub-shape</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;aColoredShape-&gt;SetCustomWidth (theSubShape, 0.25);</div>
</div><!-- fragment --><p>The presentation class <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___point_cloud.html">AIS_PointCloud</a></em> can be used for efficient drawing of large arbitrary sets of colored points. It uses <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_points.html">Graphic3d_ArrayOfPoints</a></em> to pass point data into <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_open_gl.html">OpenGl</a> graphic driver to draw a set points as an array of "point sprites". The point data is packed into vertex buffer object for performance.</p><ul>
<li>The type of point marker used to draw points can be specified as a presentation aspect.</li>
<li>The presentation provides selection by a bounding box of the visualized set of points. It supports two display / highlighting modes: points or bounding box.</li>
</ul>
<div class="image">
<img src="point_cloud.png" alt="point_cloud.png"/>
<div class="caption">
A random colored cloud of points</div></div>
<p> Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Handle(Graphic3d_ArrayOfPoints) aPoints = new Graphic3d_ArrayOfPoints (2000, Standard_True);</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;aPoints-&gt;AddVertex (gp_Pnt(-40.0, -40.0, -40.0), Quantity_Color (Quantity_NOC_BLUE1));</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;aPoints-&gt;AddVertex (gp_Pnt (40.0,  40.0,  40.0), Quantity_Color (Quantity_NOC_BLUE2));</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Handle(AIS_PointCloud) aPntCloud = new AIS_PointCloud();</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;aPntCloud-&gt;SetPoints (aPoints);</div>
</div><!-- fragment --><p>The draw command <em>vpointcloud</em> builds a cloud of points from shape triangulation. This command can also draw a sphere surface or a volume with a large amount of points (more than one million).</p>
<h3><a class="anchor" id="occt_visu_3_5_3"></a>
Relations</h3>
<p>The <b>Relation</b> is made up of constraints on one or more interactive shapes and the corresponding reference geometry. For example, you might want to constrain two edges in a parallel relation. This constraint is considered as an object in its own right, and is shown as a sensitive primitive. This takes the graphic form of a perpendicular arrow marked with the || symbol and lying between the two edges.</p>
<p>The following relations are provided by <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a></em>:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___concentric_relation.html">AIS_ConcentricRelation</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___fix_relation.html">AIS_FixRelation</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___identic_relation.html">AIS_IdenticRelation</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___parallel_relation.html">AIS_ParallelRelation</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___perpendicular_relation.html">AIS_PerpendicularRelation</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___relation.html">AIS_Relation</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___symmetric_relation.html">AIS_SymmetricRelation</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___tangent_relation.html">AIS_TangentRelation</a></em></li>
</ul>
<p>The list of relations is not exhaustive.</p>
<h3><a class="anchor" id="occt_visu_3_5_4"></a>
Dimensions</h3>
<ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___angle_dimension.html">AIS_AngleDimension</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___chamf3d_dimension.html">AIS_Chamf3dDimension</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___diameter_dimension.html">AIS_DiameterDimension</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___dimension_owner.html">AIS_DimensionOwner</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___length_dimension.html">AIS_LengthDimension</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___offset_dimension.html">AIS_OffsetDimension</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___radius_dimension.html">AIS_RadiusDimension</a></em></li>
</ul>
<h3><a class="anchor" id="occt_visu_3_5_5"></a>
MeshVS_Mesh</h3>
<p><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___mesh.html">MeshVS_Mesh</a></em> is an Interactive Object that represents meshes. This object differs from the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a></em> as its geometrical data is supported by the data source <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___data_source.html">MeshVS_DataSource</a></em> that describes nodes and elements of the object. As a result, you can provide your own data source.</p>
<p>However, the <em>DataSource</em> does not provide any information on attributes, for example nodal colors, but you can apply them in a special way &ndash; by choosing the appropriate presentation builder.</p>
<p>The presentations of <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___mesh.html">MeshVS_Mesh</a></em> are built with the presentation builders <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___prs_builder.html">MeshVS_PrsBuilder</a></em>. You can choose between the builders to represent the object in a different way. Moreover, you can redefine the base builder class and provide your own presentation builder.</p>
<p>You can add/remove builders using the following methods: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;MeshVS_Mesh::AddBuilder (const Handle (MeshVS_PrsBuilder) &amp;Builder, Standard_Boolean TreatAsHilighter) </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;MeshVS_Mesh::RemoveBuilder (const Standard_Integer  Index) </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;MeshVS_Mesh::RemoveBuilderById (const Standard_Integer Id) </div>
</div><!-- fragment --><p>There is a set of reserved display and highlighting mode flags for <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___mesh.html">MeshVS_Mesh</a></em>. Mode value is a number of bits that allows selecting additional display parameters and combining the following mode flags, which allow displaying mesh in wireframe, shading and shrink modes: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;MeshVS_DMF_WireFrame</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;MeshVS_DMF_Shading</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;MeshVS_DMF_Shrink</div>
</div><!-- fragment --><p>It is also possible to display deformed mesh in wireframe, shading or shrink modes usung : </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;MeshVS_DMF_DeformedPrsWireFrame</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;MeshVS_DMF_DeformedPrsShading  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;MeshVS_DMF_DeformedPrsShrink</div>
</div><!-- fragment --><p>The following methods represent different kinds of data : </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;MeshVS_DMF_VectorDataPrs  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;MeshVS_DMF_NodalColorDataPrs</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;MeshVS_DMF_ElementalColorDataPrs</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;MeshVS_DMF_TextDataPrs</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;MeshVS_DMF_EntitiesWithData</div>
</div><!-- fragment --><p>The following methods provide selection and highlighting : </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;MeshVS_DMF_SelectionPrs</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;MeshVS_DMF_HilightPrs</div>
</div><!-- fragment --><p><em>MeshVS_DMF_User</em> is a user-defined mode.</p>
<p>These values will be used by the presentation builder. There is also a set of selection modes flags that can be grouped in a combination of bits:</p><ul>
<li><em>MeshVS_SMF_0D</em></li>
<li><em>MeshVS_SMF_Link</em></li>
<li><em>MeshVS_SMF_Face</em></li>
<li><em>MeshVS_SMF_Volume</em></li>
<li><em>MeshVS_SMF_Element</em> &ndash; groups <em>0D, Link, Face</em> and <em>Volume</em> as a bit mask ;</li>
<li><em>MeshVS_SMF_Node</em></li>
<li><em>MeshVS_SMF_All</em> &ndash; groups <em>Element</em> and <em>Node</em> as a bit mask;</li>
<li><em>MeshVS_SMF_Mesh</em></li>
<li><em>MeshVS_SMF_Group</em></li>
</ul>
<p>Such an object, for example, can be used for displaying the object and stored in the STL file format:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// read the data and create a data source</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle  (StlMesh_Mesh) aSTLMesh = RWStl::ReadFile (aFileName); </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Handle  (XSDRAWSTLVRML_DataSource) aDataSource = new XSDRAWSTLVRML_DataSource (aSTLMesh); </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;// create mesh </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Handle  (MeshVS_Mesh) aMesh = new MeshVS(); </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;aMesh-&gt;SetDataSource  (aDataSource); </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;// use default presentation builder</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;Handle  (MeshVS_MeshPrsBuilder) aBuilder =  new  MeshVS_MeshPrsBuilder (aMesh); </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;aMesh-&gt;AddBuilder  (aBuilder, Standard_True); </div>
</div><!-- fragment --><p><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___nodal_color_prs_builder.html">MeshVS_NodalColorPrsBuilder</a></em> allows representing a mesh with a color scaled texture mapped on it. To do this you should define a color map for the color scale, pass this map to the presentation builder, and define an appropriate value in the range of 0.0 - 1.0 for every node.</p>
<p>The following example demonstrates how you can do this (check if the view has been set up to display textures):</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// assign nodal builder to the mesh</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle  (MeshVS_NodalColorPrsBuilder) aBuilder = new MeshVS_NodalColorPrsBuilder </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        (aMesh,MeshVS_DMF_NodalColorDataPrs | MeshVS_DMF_OCCMask); </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;aBuilder-&gt;UseTexture  (Standard_True); </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;// prepare color map</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Aspect_SequenceOfColor  aColorMap; </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;aColorMap.Append  ((Quantity_NameOfColor) Quantity_NOC_RED); </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;aColorMap.Append  ((Quantity_NameOfColor) Quantity_NOC_BLUE1); </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;// assign color scale map  values (0..1) to nodes</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;TColStd_DataMapOfIntegerReal  aScaleMap; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;...</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;// iterate through the  nodes and add an node id and an appropriate value to the map</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;aScaleMap.Bind  (anId, aValue); </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;// pass color map and color scale values to the builder</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;aBuilder-&gt;SetColorMap  (aColorMap); </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;aBuilder-&gt;SetInvalidColor  (Quantity_NOC_BLACK); </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;aBuilder-&gt;SetTextureCoords  (aScaleMap); </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;aMesh-&gt;AddBuilder  (aBuilder, Standard_True); </div>
</div><!-- fragment --><h2><a class="anchor" id="occt_visu_3_6"></a>
Dynamic Selection</h2>
<p>The dynamic selection represents the topological shape, which you want to select, by decomposition of <em>sensitive primitives</em> &ndash; the sub-parts of the shape that will be detected and highlighted. The sets of these primitives are handled by the powerful three-level <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> tree selection algorithm.</p>
<p>For more details on the algorithm and examples of usage, please, refer to <a class="el" href="occt_user_guides__visualization.html#occt_visu_2_2">Selection</a> chapter.</p>
<h1><a class="anchor" id="occt_visu_4"></a>
3D Presentations</h1>
<h2><a class="anchor" id="occt_visu_4_1"></a>
Glossary of 3D terms</h2>
<ul>
<li><b>Anti-aliasing</b> This mode attempts to improve the screen resolution by drawing lines and curves in a mixture of colors so that to the human eye the line or curve is smooth. The quality of the result is linked to the quality of the algorithm used by the workstation hardware.</li>
<li><b>Depth-cueing</b> Reduces the color intensity for the portion of an object further away from the eye to give the impression of depth. This is used for wireframe objects. Shaded objects do not require this.</li>
<li><b>Group</b> &ndash; a set of primitives and attributes on those primitives. Primitives and attributes may be added to a group but cannot be removed from it, unless erased globally. A group can have a pick identity.</li>
<li><b>Light</b> There are five kinds of light source &ndash; ambient, headlight, directional, positional and spot. The light is only activated in a shading context in a view.</li>
<li><b>Primitive</b> &ndash; a drawable element. It has a definition in 3D space. Primitives can either be lines, faces, text, or markers. Once displayed markers and text remain the same size. Lines and faces can be modified e.g. zoomed. Primitives must be stored in a group.</li>
<li><b>Structure</b> &ndash; manages a set of groups. The groups are mutually exclusive. A structure can be edited, adding or removing groups. A structure can reference other structures to form a hierarchy. It has a default (identity) transformation and other transformations may be applied to it (rotation, translation, scale, etc). It has no default attributes for the primitive lines, faces, markers, and text. Attributes may be set in a structure but they are overridden by the attributes in each group. Each structure has a display priority associated with it, which rules the order in which it is redrawn in a 3D viewer. If the visualization mode is incompatible with the view it is not displayed in that view, e.g. a shading-only object is not visualized in a wireframe view.</li>
<li><b>View</b> &ndash; is defined by a view orientation, a view mapping, and a context view.</li>
<li><b>Viewer</b> &ndash; manages a set of views.</li>
<li><b>View orientation</b> &ndash; defines the manner in which the observer looks at the scene in terms of View Reference Coordinates.</li>
<li><b>View mapping</b> &ndash; defines the transformation from View Reference Coordinates to the Normalized Projection Coordinates. This follows the Phigs scheme.</li>
<li><b>Z-Buffering</b> &ndash; a form of hidden surface removal in shading mode only. This is always active for a view in the shading mode. It cannot be suppressed.</li>
</ul>
<h2><a class="anchor" id="occt_visu_4_2"></a>
Graphic primitives</h2>
<p>The <em>Graphic3d</em> package is used to create 3D graphic objects in a 3D viewer. These objects called <b>structures</b> are made up of groups of primitives and attributes, such as polylines, planar polygons with or without holes, text and markers, and attributes, such as color, transparency, reflection, line type, line width, and text font. A group is the smallest editable element of a structure. A transformation can be applied to a structure. Structures can be connected to form a tree of structures, composed by transformations. Structures are globally manipulated by the viewer.</p>
<p>Graphic structures can be:</p><ul>
<li>Displayed,</li>
<li>Highlighted,</li>
<li>Erased,</li>
<li>Transformed,</li>
<li>Connected to form a tree hierarchy of structures, created by transformations.</li>
</ul>
<p>There are classes for:</p><ul>
<li>Visual attributes for lines, faces, markers, text, materials,</li>
<li>Vectors and vertices,</li>
<li>Graphic objects, groups, and structures.</li>
</ul>
<h3><a class="anchor" id="occt_visu_4_2_2"></a>
Structure hierarchies</h3>
<p>The root is the top of a structure hierarchy or structure network. The attributes of a parent structure are passed to its descendants. The attributes of the descendant structures do not affect the parent. Recursive structure networks are not supported.</p>
<h3><a class="anchor" id="occt_visu_4_2_3"></a>
Graphic primitives</h3>
<ul>
<li><b>Markers</b><ul>
<li>Have one or more vertices,</li>
<li>Have a type, a scale factor, and a color,</li>
<li>Have a size, shape, and orientation independent of transformations.</li>
</ul>
</li>
<li><b>Polygons</b><ul>
<li>Have one closed boundary,</li>
<li>Have at least three vertices,</li>
<li>Are planar and have a normal,</li>
<li>Have interior attributes &ndash; style, color, front and back material, texture and reflection ratio,</li>
<li>Have a boundary with the following attributes &ndash; type, width scale factor, color. The boundary is only drawn when the interior style is hollow.</li>
</ul>
</li>
<li><b>Polygons with holes</b><ul>
<li>Have multiple closed boundaries, each one with at least three vertices,</li>
<li>Are planar and have a normal,</li>
<li>Have interior attributes &ndash; style, color, front and back material,</li>
<li>Have a boundary with the following attributes &ndash; type, width scale factor, color. The boundary is only drawn when the interior style is hollow.</li>
</ul>
</li>
<li><b>Polylines</b><ul>
<li>Have two or more vertices,</li>
<li>Have the following attributes &ndash; type, width scale factor, color.</li>
</ul>
</li>
<li><b>Text</b><ul>
<li>Has geometric and non-geometric attributes,</li>
<li>Geometric attributes &ndash; character height, character up vector, text path, horizontal and vertical alignment, orientation, three-dimensional position, zoomable flag</li>
<li>Non-geometric attributes &ndash; text font, character spacing, character expansion factor, color.</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="occt_visu_4_2_4"></a>
Primitive  arrays</h3>
<p>Primitive arrays are a more efficient approach to describe and display the primitives from the aspects of memory usage and graphical performance. The key feature of the primitive arrays is that the primitive data is not duplicated. For example, two polygons could share the same vertices, so it is more efficient to keep the vertices in a single array and specify the polygon vertices with indices of this array. In addition to such kind of memory savings, the <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_open_gl.html">OpenGl</a> graphics driver provides the Vertex Buffer Objects (VBO). VBO is a sort of video memory storage that can be allocated to hold the primitive arrays, thus making the display operations more efficient and releasing the RAM memory.</p>
<p>The Vertex Buffer Objects are enabled by default, but VBOs availability depends on the implementation of <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_open_gl.html">OpenGl</a>. If the VBOs are unavailable or there is not enough video memory to store the primitive arrays, the RAM memory will be used to store the arrays.</p>
<p>The Vertex Buffer Objects can be disabled at the application level. You can use the method <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___graphic_driver.html#a91ded3f7db460327c8af5a2df7f6b4c0">Graphic3d_GraphicDriver::EnableVBO</a> (const Standard_Boolean status)</em> to enable/disable VBOs:</p>
<p>The following example shows how to disable the VBO support:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// get the graphic  driver</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle (Graphic3d_GraphicDriver) aDriver =  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  myAISContext-&gt;CurrentViewer()-&gt;Driver(); </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;// disable VBO support</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;aDriver-&gt;EnableVBO (Standard_False); </div>
</div><!-- fragment --><p><b>Note</b> that the use of Vertex Buffer Objects requires the application level primitive data provided by the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html">Graphic3d_ArrayOfPrimitives</a></em> to be transferred to the video memory. <em>TKOpenGl</em> transfers the data and releases the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html">Graphic3d_ArrayOfPrimitives</a></em> internal pointers to the primitive data. Thus it might be necessary to pay attention to such kind of behaviour, as the pointers could be modified (nullified) by the <em>TKOpenGl</em>.</p>
<p>The different types of primitives could be presented with the following primitive arrays:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_points.html">Graphic3d_ArrayOfPoints</a>,</em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_polygons.html">Graphic3d_ArrayOfPolygons</a>,</em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_polylines.html">Graphic3d_ArrayOfPolylines</a>,</em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_quadrangles.html">Graphic3d_ArrayOfQuadrangles</a>,</em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_quadrangle_strips.html">Graphic3d_ArrayOfQuadrangleStrips</a>,</em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_segments.html">Graphic3d_ArrayOfSegments</a>,</em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_triangle_fans.html">Graphic3d_ArrayOfTriangleFans</a>,</em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_triangles.html">Graphic3d_ArrayOfTriangles</a>,</em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_triangle_strips.html">Graphic3d_ArrayOfTriangleStrips</a>.</em></li>
</ul>
<p>The <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html">Graphic3d_ArrayOfPrimitives</a></em> is a base class for these primitive arrays.</p>
<p>Method <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html#a68a0816125333bc14042a340fc47ed12">Graphic3d_ArrayOfPrimitives::AddVertex</a></em> allows adding There is a set of similar methods to add vertices to the primitive array.</p>
<p>These methods take vertex coordinates as an argument and allow you to define the color, the normal and the texture coordinates assigned to the vertex. The return value is the actual number of vertices in the array.</p>
<p>You can also modify the values assigned to the vertex or query these values by the vertex index:</p><ul>
<li><em>void <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html#a94390c8b84831a103e5c5923876833cf">Graphic3d_ArrayOfPrimitives::SetVertice</a></em></li>
<li><em>void <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html#acf468ff6846e953d75e4aec30f1be0d3">Graphic3d_ArrayOfPrimitives::SetVertexColor</a></em></li>
<li><em>void <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html#a5f43b2762965393e7b65ed037f1c84d0">Graphic3d_ArrayOfPrimitives::SetVertexNormal</a></em></li>
<li><em>void <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html#ae8a631b428bd69053a5e54618e609fcf">Graphic3d_ArrayOfPrimitives::SetVertexTexel</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/classgp___pnt.html">gp_Pnt</a> Graphic3d_ArrayOfPrimitives::Vertices</em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/classgp___dir.html">gp_Dir</a> <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html#aab69f25720d50da77239fcf42687906e">Graphic3d_ArrayOfPrimitives::VertexNormal</a></em></li>
<li><em>gp_Pnt3d <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html#ac92b0051b2ebfd14d01b544b1b4f10c0">Graphic3d_ArrayOfPrimitives::VertexTexel</a></em></li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_quantity___color.html">Quantity_Color</a> <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html#affdb2612e3fb829b2e24c033af6403cf">Graphic3d_ArrayOfPrimitives::VertexColor</a></em></li>
<li><em>void Graphic3d_ArrayOfPrimitives::Vertices</em></li>
<li><em>void <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html#aab69f25720d50da77239fcf42687906e">Graphic3d_ArrayOfPrimitives::VertexNormal</a></em></li>
<li><em>void <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html#ac92b0051b2ebfd14d01b544b1b4f10c0">Graphic3d_ArrayOfPrimitives::VertexTexel</a></em></li>
<li><em>void <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html#affdb2612e3fb829b2e24c033af6403cf">Graphic3d_ArrayOfPrimitives::VertexColor</a></em></li>
</ul>
<p>The following example shows how to define an array of points:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// create an array</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle (Graphic3d_ArrayOfPoints) anArray = new Graphic3d_ArrayOfPoints (aVerticiesMaxCount); </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;// add vertices to the array</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;anArray-&gt;AddVertex  (10.0, 10.0, 10.0); </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;anArray-&gt;AddVertex  (0.0, 10.0, 10.0); </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;// add the array to the structure</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;Handle (Graphic3d_Group) aGroup  =  Prs3d_Root::CurrentGroup (aPrs); </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;aGroup-&gt;BeginPrimitives (); </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;aGroup-&gt;AddPrimitiveArray (anArray); </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;aGroup-&gt;EndPrimitives (); </div>
</div><!-- fragment --><p>If the primitives share the same vertices (polygons, triangles, etc.) then you can define them as indices of the vertices array.</p>
<p>The method <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html#acc0b07dd817f5bc0e586f08dadbcc836">Graphic3d_ArrayOfPrimitives::AddEdge</a></em> allows defining the primitives by indices. This method adds an "edge" in the range <em> [1, VertexNumber() ] </em> in the array.</p>
<p>It is also possible to query the vertex defined by an edge using method <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html#a0a94830dbbe9920a81f2468719995591">Graphic3d_ArrayOfPrimitives::Edge</a></em></p>
<p>The following example shows how to define an array of triangles:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// create an array</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Standard_Boolean  IsNormals     = Standard_False;  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Standard_Boolean  IsColors      = Standard_False; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Standard_Boolean  IsTextureCrds = Standard_False; </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Handle (Graphic3d_ArrayOfTriangles) anArray =  </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;          new Graphic3d_ArrayOfTriangles (aVerticesMaxCount, </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;                                          aEdgesMaxCount, </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;                                          IsNormals, </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;                                          IsColors, </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;                                          IsTextureCrds); </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;// add vertices to the array</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;anArray-&gt;AddVertex  (-1.0, 0.0, 0.0);   // vertex 1</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;anArray-&gt;AddVertex  ( 1.0, 0.0, 0.0);   // vertex 2</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;anArray-&gt;AddVertex  ( 0.0, 1.0, 0.0);   // vertex 3 </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;anArray-&gt;AddVertex  ( 0.0,-1.0, 0.0);   // vertex 4 </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;// add edges to the array</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;anArray-&gt;AddEdge  (1);  // first triangle</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;anArray-&gt;AddEdge  (2); </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;anArray-&gt;AddEdge  (3); </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;anArray-&gt;AddEdge  (1);  // second triangle</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;anArray-&gt;AddEdge  (2); </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;anArray-&gt;AddEdge  (4); </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;// add the array to the structure</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;Handle  (Graphic3d_Group) aGroup =  Prs3d_Root::CurrentGroup (aPrs); </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;aGroup-&gt;BeginPrimitives  (); </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;aGroup-&gt;AddPrimitiveArray  (anArray); </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;aGroup-&gt;EndPrimitives  (); </div>
</div><!-- fragment --><p>If the primitive array presents primitives built from sequential sets of vertices, for example polygons, then you can specify the bounds, or the number of vertices for each primitive. You can use the method <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___array_of_primitives.html#a9265f34c0867a351b0b30c6df7fba1cf">Graphic3d_ArrayOfPrimitives::AddBound</a></em> to define the bounds and the color for each bound. This method returns the actual number of bounds.</p>
<p>It is also possible to set the color and query the number of edges in the bound and bound color. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Standard_Integer  Graphic3d_ArrayOfPrimitives::Bound</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Quantity_Color  Graphic3d_ArrayOfPrimitives::BoundColor</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;void  Graphic3d_ArrayOfPrimitives::BoundColor</div>
</div><!-- fragment --><p>The following example shows how to define an array of polygons:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// create an array</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Standard_Boolean  IsNormals      = Standard_False;  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Standard_Boolean  IsVertexColors = Standard_False; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Standard_Boolean  IsFaceColors   = Standard_False; </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Standard_Boolean  IsTextureCrds  = Standard_False; </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Handle (Graphic3d_ArrayOfPolygons) anArray =  </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;          new Graphic3d_ArrayOfPolygons (aVerticesMaxCount, </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;                                         aBoundsMaxCount, </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;                                         aEdgesMaxCount, </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;                                         IsNormals, </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                                         IsVertexColors, </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;                                         IsFaceColors, </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;                                         IsTextureCrds); </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;// add bounds to the array, first polygon</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;anArray-&gt;AddBound (3);  </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;anArray-&gt;AddVertex (-1.0,  0.0, 0.0);    </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;anArray-&gt;AddVertex  ( 1.0, 0.0, 0.0);    </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;anArray-&gt;AddVertex  ( 0.0, 1.0, 0.0);    </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;// add bounds to the array, second polygon</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;anArray-&gt;AddBound (4); </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;anArray-&gt;AddVertex (-1.0,  0.0, 0.0);    </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;anArray-&gt;AddVertex  ( 1.0, 0.0, 0.0);    </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;anArray-&gt;AddVertex  ( 1.0,-1.0, 0.0);    </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;anArray-&gt;AddVertex  (-1.0,-1.0, 0.0);    </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;// add the array to the structure </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;Handle  (Graphic3d_Group) aGroup = Prs3d_Root::CurrentGroup  (aPrs); </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;aGroup-&gt;BeginPrimitives  (); </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;aGroup-&gt;AddPrimitiveArray  (anArray); </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;aGroup-&gt;EndPrimitives  (); </div>
</div><!-- fragment --><p>There are also several helper methods. You can get the type of the primitive array: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Graphic3d_TypeOfPrimitiveArray </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Graphic3d_ArrayOfPrimitives::Type</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Standard_CString  Graphic3d_ArrayOfPrimitives::StringType</div>
</div><!-- fragment --><p>and check if the primitive array provides normals, vertex colors and vertex texels (texture coordinates):</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Standard_Boolean Graphic3d_ArrayOfPrimitives::HasVertexNormals</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Standard_Boolean Graphic3d_ArrayOfPrimitives::HasVertexColors</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Standard_Boolean Graphic3d_ArrayOfPrimitives::HasVertexTexels</div>
</div><!-- fragment --><p> or get the number of vertices, edges and bounds: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Standard_Integer Graphic3d_ArrayOfPrimitives::VertexNumber</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Standard_Integer Graphic3d_ArrayOfPrimitives::EdgeNumber</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Standard_Integer Graphic3d_ArrayOfPrimitives::BoundNumber</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_2_5"></a>
Text primitive</h3>
<p>The <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_open_gl.html">OpenGl</a> graphics driver uses advanced text rendering powered by FTGL library. This library provides vector text rendering, as a result the text can be rotated and zoomed without quality loss. <em>Graphic3d</em> text primitives have the following features:</p><ul>
<li>fixed size (non-zoomable) or zoomable,</li>
<li>can be rotated to any angle in the view plane,</li>
<li>support unicode charset.</li>
</ul>
<p>The text attributes for the group could be defined with the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___aspect_text3d.html">Graphic3d_AspectText3d</a></em> attributes group. To add any text to the graphic structure you can use the following methods: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void Graphic3d_Group::Text</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;           (const Standard_CString AText, </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;            const Graphic3d_Vertex&amp; APoint, </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;            const Standard_Real AHeight, </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;            const Quantity_PlaneAngle AAngle, </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;            const Graphic3d_TextPath ATp, </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;            const Graphic3d_HorizontalTextAlignment  AHta, </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;            const Graphic3d_VerticalTextAlignment  AVta, </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;            const Standard_Boolean EvalMinMax), </div>
</div><!-- fragment --><p> <em>AText</em> parameter is the text string, <em>APoint</em> is the three-dimensional position of the text, <em>AHeight</em> is the text height, <em>AAngle</em> is the orientation of the text (at the moment, this parameter has no effect, but you can specify the text orientation through the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___aspect_text3d.html">Graphic3d_AspectText3d</a></em> attributes).</p>
<p><em>ATp</em> parameter defines the text path, <em>AHta</em> is the horizontal alignment of the text, <em>AVta</em> is the vertical alignment of the text.</p>
<p>You can pass <em>Standard_False</em> as <em>EvalMinMax</em> if you do not want the graphic3d structure boundaries to be affected by the text position.</p>
<p><b>Note</b> that the text orientation angle can be defined by <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___aspect_text3d.html">Graphic3d_AspectText3d</a></em> attributes. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void  Graphic3d_Group::Text</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;          (const Standard_CString AText, </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;           const Graphic3d_Vertex&amp; APoint, </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;           const Standard_Real AHeight, </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;           const Standard_Boolean EvalMinMax) </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;void  Graphic3d_Group::Text</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;          (const TCcollection_ExtendedString  &amp;AText,  </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;           const Graphic3d_Vertex&amp; APoint, </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;           const Standard_Real AHeight, </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;           const Quantity_PlaneAngle AAngle, </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;           const Graphic3d_TextPath ATp, </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;           const Graphic3d_HorizontalTextAlignment  AHta, </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;           const Graphic3d_VerticalTextAlignment  AVta, </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;           const Standard_Boolean EvalMinMax) </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;void  Graphic3d_Group::Text</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;          (const TCcollection_ExtendedString  &amp;AText,  </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;           const Graphic3d_Vertex&amp; APoint, </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;           const Standard_Real AHeight, </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;           const Standard_Boolean EvalMinMax) </div>
</div><!-- fragment --><p>See the example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// get the group</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle (Graphic3d_Group) aGroup =  Prs3d_Root::CurrentGroup  (aPrs);  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;// change the text  aspect</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Handle(Graphic3d_AspectText3d) aTextAspect =  new Graphic3d_AspectText3d (); </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;aTextAspect-&gt;SetTextZoomable  (Standard_True); </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;aTextAspect-&gt;SetTextAngle  (45.0); </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;aGroup-&gt;SetPrimitivesAspect (aTextAspect);   </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;// add a text primitive  to the structure</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;Graphic3d_Vertex aPoint (1, 1, 1); </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;aGroup-&gt;Text (Standard_CString (&quot;Text&quot;), aPoint, 16.0); </div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_2_6"></a>
Materials</h3>
<p>A <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___material_aspect.html">Graphic3d_MaterialAspect</a></em> is defined by:</p><ul>
<li>Transparency;</li>
<li>Diffuse reflection &ndash; a component of the object color;</li>
<li>Ambient reflection;</li>
<li>Specular reflection &ndash; a component of the color of the light source;</li>
<li>Refraction index.</li>
</ul>
<p>The following items are required to determine the three colors of reflection:</p><ul>
<li>Color;</li>
<li>Coefficient of diffuse reflection;</li>
<li>Coefficient of ambient reflection;</li>
<li>Coefficient of specular reflection.</li>
</ul>
<h3><a class="anchor" id="occt_visu_4_2_7"></a>
Textures</h3>
<p>A <em>texture</em> is defined by a name. Three types of texture are available:</p><ul>
<li>1D;</li>
<li>2D;</li>
<li>Environment mapping.</li>
</ul>
<h3><a class="anchor" id="occt_visu_4_2_8"></a>
Shaders</h3>
<p>OCCT visualization core supports GLSL shaders. Currently OCCT supports only vertex and fragment GLSL shader. Shaders can be assigned to a generic presentation by its drawer attributes (Graphic3d aspects). To enable custom shader for a specific AISShape in your application, the following API functions are used:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// Create shader program</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle(Graphic3d_ShaderProgram) aProgram = new Graphic3d_ShaderProgram();</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;// Attach vertex shader</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;aProgram-&gt;AttachShader (Graphic3d_ShaderObject::CreateFromFile(</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;                               Graphic3d_TOS_VERTEX, &quot;&lt;Path to VS&gt;&quot;));</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;// Attach fragment shader</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;aProgram-&gt;AttachShader (Graphic3d_ShaderObject::CreateFromFile(</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;                               Graphic3d_TOS_FRAGMENT, &quot;&lt;Path to FS&gt;&quot;));</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;// Set values for custom uniform variables (if they are)</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;aProgram-&gt;PushVariable (&quot;MyColor&quot;, Graphic3d_Vec3(0.0f, 1.0f, 0.0f));</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;// Set aspect property for specific AISShape</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;theAISShape-&gt;Attributes()-&gt;ShadingAspect()-&gt;Aspect()-&gt;SetShaderProgram (aProgram);</div>
</div><!-- fragment --><h2><a class="anchor" id="occt_visu_4_3"></a>
Graphic attributes</h2>
<h3><a class="anchor" id="occt_visu_4_3_1"></a>
Aspect package overview</h3>
<p>The <em>Aspect</em> package provides classes for the graphic elements in the viewer:</p><ul>
<li>Groups of graphic attributes;</li>
<li>Edges, lines, background;</li>
<li>Window;</li>
<li>Driver;</li>
<li>Enumerations for many of the above.</li>
</ul>
<h2><a class="anchor" id="occt_visu_4_4"></a>
3D view facilities</h2>
<h3><a class="anchor" id="occt_visu_4_4_1"></a>
Overview</h3>
<p>The <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_v3d.html">V3d</a></em> package provides the resources to define a 3D viewer and the views attached to this viewer (orthographic, perspective). This package provides the commands to manipulate the graphic scene of any 3D object visualized in a view on screen.</p>
<p>A set of high-level commands allows the separate manipulation of parameters and the result of a projection (Rotations, Zoom, Panning, etc.) as well as the visualization attributes (Mode, Lighting, Clipping, Depth-cueing, etc.) in any particular view.</p>
<p>The <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_v3d.html">V3d</a></em> package is basically a set of tools directed by commands from the viewer front-end. This tool set contains methods for creating and editing classes of the viewer such as:</p><ul>
<li>Default parameters of the viewer,</li>
<li>Views (orthographic, perspective),</li>
<li>Lighting (positional, directional, ambient, spot, headlight),</li>
<li>Clipping planes (note that only Z-clipping planes can work with the Phigs interface),</li>
<li>Instantiated sequences of views, planes, light sources, graphic structures, and picks,</li>
<li>Various package methods.</li>
</ul>
<h3><a class="anchor" id="occt_visu_4_4_2"></a>
A programming example</h3>
<p>This sample TEST program for the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_v3d.html">V3d</a></em> Package uses primary packages <em>Xw</em> and <em>Graphic3d</em> and secondary packages <em>Visual3d, Aspect, Quantity, Phigs</em> and <em>math</em>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;//Create a default display  connection</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle(Aspect_DisplayConnection)  aDisplayConnection = new  Aspect_DisplayConnection(); </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;//Create a Graphic Driver from  the default Aspect_DisplayConnection</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Handle(OpenGl_GraphicDriver)  GD = new OpenGl_GraphicDriver (aDisplayConnection);</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;//Create a Viewer to this Driver </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Handle(V3d_Viewer)  VM = new V3d_Viewer(GD, 400.,  </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    // Space size  </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    V3d_Xpos,</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    // Default projection  </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    Quantity_NOC_DARKVIOLET, </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    // Default  background  </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    V3d_ZBUFFER, </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    // Type of  visualization  </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    V3d_GOURAUD, </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    // Shading  model  </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    V3d_WAIT); </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    // Update mode   </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;// Create a structure in this  Viewer </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;Handle(Graphic3d_Structure) S =  new  Graphic3d_Structure(VM-&gt;Viewer()) ;  </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;// Type of structure </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;S-&gt;SetVisual (Graphic3d_TOS_SHADING);  </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;// Create a group of primitives  in this structure</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;Handle(Graphic3d_Group) G = new Graphic3d_Group(S) ;  </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;// Fill this group with  one polygon of size 100  </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;Graphic3d_Array1OfVertex Points(0,3) ;  </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;Points(0).SetCoord(-100./2.,-100./2.,-100./2.) ;  </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;Points(1).SetCoord(-100./2., 100./2.,-100./2.) ;  </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;Points(2).SetCoord( 100./2., 100./2.,-100./2.) ;  </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;Points(3).SetCoord( 100./2.,-100./2.,-100./2.) ;  </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;Normal.SetCoord(0.,0.,1.) ;  </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;G-&gt;Polygon(Points,Normal) ;  </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;//  Create Ambient and Infinite Lights in this Viewer</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;Handle(V3d_AmbientLight) L1  = new V3d_AmbientLight  </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    (VM,Quantity_NOC_GRAY50)  ;  </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;Handle(V3d_DirectionalLight)  L2 = new V3d_DirectionalLight  </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    (VM,V3d_XnegYnegZneg,Quantity_NOC_WHITE)  ;  </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;// Create a 3D quality  Window with the same DisplayConnection</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;Handle(Xw_Window) W =  new Xw_Window(aDisplayConnection,&quot;Test  V3d&quot;,0.5,0.5,0.5,0.5) ;  </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;// Map this Window to  this screen</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;W-&gt;Map() ;  </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;// Create a Perspective  View in this Viewer</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;Handle(V3d_View) aView = new V3d_View(VM);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;aView-&gt;Camera()-&gt;SetProjectionType (Graphic3d_Camera::Projection_Perspective);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;// Associate this View with the Window</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;aView -&gt;SetWindow(W);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;// Display ALL structures in this View</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;VM-&gt;Viewer()-&gt;Display();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;// Finally update the Visualization in this View</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;aView-&gt;Update();</div>
</div><!-- fragment --><p>As an alternative to manual setting of perspective parameters the <em>V3d_View::ZfitAll()</em> and <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_v3d___view.html#a2a546b76cfde693f5bde66b19e9bdd67">V3d_View::FitAll()</a></em> functions can be used:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// Display shape in Viewer VM</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle(AIS_InteractiveContext) aContext = new AIS_InteractiveContext (VM);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;aContext-&gt;Display(shape);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;// Create a Perspective View in Viewer VM</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Handle(V3d_View) V = new V3d_View (VM);</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;aview-&gt;Camera()-&gt;SetProjectionType (Graphic3d_Camera::Projection_Perspective);</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;// Change Z-min and Z-max planes of projection volume to match the displayed objects</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;V-&gt;ZFitAll();</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;// Fit view to object size</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;V-&gt;FitAll();</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_4_3"></a>
Define viewing parameters</h3>
<p>View projection and orientation in OCCT <em>v3d</em> view are driven by camera. The camera calculates and supplies projection and view orientation matrices for rendering by OpenGL. The allows to the user to control all projection parameters. The camera is defined by the following properties:</p>
<ul>
<li><b>Eye</b> &ndash; defines the observer (camera) position. Make sure the Eye point never gets between the Front and Back clipping planes.</li>
<li><b>Center</b> &ndash; defines the origin of View Reference Coordinates (where camera is aimed at).</li>
<li><b>Direction</b> &ndash; defines the direction of camera view (from the Eye to the Center).</li>
<li><b>Distance</b> &ndash; defines the distance between the Eye and the Center.</li>
<li><b>Front</b> Plane &ndash; defines the position of the front clipping plane in View Reference Coordinates system.</li>
<li><b>Back</b> Plane &ndash; defines the position of the back clipping plane in View Reference Coordinates system.</li>
<li><b>ZNear</b> &ndash; defines the distance between the Eye and the Front plane.</li>
<li><b>ZFar</b> &ndash; defines the distance between the Eye and the Back plane.</li>
</ul>
<p>Most common view manipulations (panning, zooming, rotation) are implemented as convenience methods of <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_v3d___view.html">V3d_View</a></em> class, however <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___camera.html">Graphic3d_Camera</a></em> class can also be used directly by application developers:</p>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// rotate camera by X axis on 30.0 degrees</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;gp_Trsf aTrsf;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;aTrsf.SetRotation (gp_Ax1 (gp_Pnt (0.0, 0.0, 0.0), gp_Dir (1.0, 0.0, 0.0)), 30.0);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;aView-&gt;Camera()-&gt;Transform (aTrsf);</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_4_4"></a>
Orthographic Projection</h3>
<div class="image">
<img src="view_frustum.png" alt="view_frustum.png"/>
<div class="caption">
Perspective and orthographic projection</div></div>
<p> The following code configures the camera for orthographic rendering:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// Create an orthographic View in this Viewer</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle(V3d_View) aView = new V3d_View (VM);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;aView-&gt;Camera()-&gt;SetProjectionType (Graphic3d_Camera::Projection_Orthographic);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;// update the Visualization in this View</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;aView-&gt;Update();</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_4_5"></a>
Perspective Projection</h3>
<p><b>Field of view (FOVy)</b> &ndash; defines the field of camera view by y axis in degrees (45 is default).</p>
<div class="image">
<img src="camera_perspective.png" alt="camera_perspective.png"/>
<div class="caption">
Perspective frustum</div></div>
<p> The following code configures the camera for perspective rendering:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// Create a perspective View in this Viewer</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle(V3d_View) aView = new V3d_View(VM);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;aView-&gt;Camera()-&gt;SetProjectionType (Graphic3d_Camera::Projection_Perspective);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;aView-&gt;Update();</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_4_6"></a>
Stereographic Projection</h3>
<p><b>IOD</b> &ndash; defines the intraocular distance (in world space units).</p>
<p>There are two types of IOD:</p><ul>
<li><em>IODType_Absolute</em> : Intraocular distance is defined as an absolute value.</li>
<li><em>IODType_Relative</em> : Intraocular distance is defined relative to the camera focal length (as its coefficient).</li>
</ul>
<p><b>Field of view (FOV)</b> &ndash; defines the field of camera view by y axis in degrees (45 is default).</p>
<p><b>ZFocus</b> &ndash; defines the distance to the point of stereographic focus.</p>
<div class="image">
<img src="stereo.png" alt="stereo.png"/>
<div class="caption">
Stereographic projection</div></div>
<p> To enable stereo projection, your workstation should meet the following requirements:</p>
<ul>
<li>The graphic card should support quad buffering.</li>
<li>You need active 3D glasses (LCD shutter glasses).</li>
<li>The graphic driver needs to be configured to impose quad buffering for newly created <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_open_gl.html">OpenGl</a> contexts; the viewer and the view should be created after that.</li>
</ul>
<p>In stereographic projection mode the camera prepares two projection matrices to display different stereo-pictures for the left and for the right eye. In a non-stereo camera this effect is not visible because only the same projection is used for both eyes.</p>
<p>To enable quad buffering support you should provide the following settings to the graphic driver <em>opengl_caps</em>:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Handle(OpenGl_GraphicDriver) aDriver = new OpenGl_GraphicDriver();</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;OpenGl_Caps&amp; aCaps = aDriver-&gt;ChangeOptions();</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;aCaps.contextStereo = Standard_True;</div>
</div><!-- fragment --><p>The following code configures the camera for stereographic rendering:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// Create a Stereographic View in this Viewer</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle(V3d_View) aView = new V3d_View(VM);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;aView-&gt;Camera()-&gt;SetProjectionType (Graphic3d_Camera::Projection_Stereo);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;// Change stereo parameters</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;aView-&gt;Camera()-&gt;SetIOD (IODType_Absolute, 5.0);</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;// Finally update the Visualization in this View</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;aView-&gt;Update();</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_4_7"></a>
View frustum culling</h3>
<p>The algorithm of frustum culling on CPU-side is activated by default for 3D viewer. This algorithm allows skipping the presentation outside camera at the rendering stage, providing better performance. The following features support this method:</p><ul>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___structure.html#aeb7bb54fa6cad29d79c91d0639ef5e6b">Graphic3d_Structure::CalculateBoundBox()</a></em> is used to calculate axis-aligned bounding box of a presentation considering its transformation.</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_v3d___view.html#a97c076ef0bc55227b7509b58d8d1ebe5">V3d_View::SetFrustumCulling</a></em> enables or disables frustum culling for the specified view.</li>
<li>Classes <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_open_gl___b_v_h_clip_primitive_set.html">OpenGl_BVHClipPrimitiveSet</a></em> and <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_open_gl___b_v_h_tree_selector.html">OpenGl_BVHTreeSelector</a></em> handle the detection of outer objects and usage of acceleration structure for frustum culling.</li>
<li><em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_b_v_h___binned_builder.html">BVH_BinnedBuilder</a></em> class splits several objects with null bounding box.</li>
</ul>
<h3><a class="anchor" id="occt_visu_4_4_8"></a>
Underlay and overlay layers management</h3>
<p>In addition to interactive 3d graphics displayed in the view you can display underlying and overlying graphics: text, color scales and drawings.</p>
<p>All <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_v3d.html">V3d</a></em> view graphical objects in the overlay are managed by the default layer manager (<em>V3d_LayerMgr</em>). The <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_v3d.html">V3d</a></em> view has a basic layer manager capable of displaying the color scale, but you can redefine this class to provide your own overlay and underlay graphics.</p>
<p>The method <em>V3d_View::SetLayerMgr(const Handle (V3d_LayerMgr)&amp; aMgr)</em> allows assigning a custom layer manager to the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_v3d.html">V3d</a></em> view.</p>
<p>There are three virtual methods to prepare graphics in the manager for further drawing: setting up layer dimensions and drawing static graphics. These methods can be redefined:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void  V3d_LayerMgr::Begin ()</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;void  V3d_LayerMgr::Redraw ()</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;void V3d_LayerMgr::End  ()</div>
</div><!-- fragment --><p>The layer manager controls layers (<em>Visual3d_Layer</em>) and layer items (<em>Visual3d_LayerItem</em>). Both the overlay and underlay layers can be created by the layer manager.</p>
<p>The layer entity is presented by the <em>Visual3d_Layer</em> class. This entity provides drawing services in the layer, for example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void  Visual3d_Layer::DrawText</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;void Visual3d_Layer::DrawRectangle</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;void  Visual3d_Layer::SetColor</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;void  Visual3d_Layer::SetViewport</div>
</div><!-- fragment --><p>The following example demonstrates how to draw overlay graphics by the <em>V3d_LayerMgr</em>:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// redefined method of  V3d_LayerMgr</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;void  MyLayerMgr::Redraw () </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;{ </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;   Quantity_Color aRed (Quantity_NOC_RED); </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;   myOverlayLayer-&gt;SetColor (aRed); </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;   myOverlayLayer-&gt;DrawRectangle (0, 0, 100, 100); </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;} </div>
</div><!-- fragment --><p>The layer contains layer items that will be displayed on view redraw. Such items are <em>Visual3d_LayerItem</em> entities. To manipulate <em>Visual3d_LayerItem</em> entities assigned to the layer's internal list you can use the following methods:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void  Visual3d_Layer::AddLayerItem (const Handle (Visual3d_LayerItem)&amp;  Item)  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;void  Visual3d_Layer::RemoveLayerItem (const Handle (Visual3d_LayerItem)&amp;  Item)   </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;void  Visual3d_Layer::RemoveAllLayerItems ()</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;const  Visual3d_NListOfLayerItem&amp; Visual3d_Layer::GetLayerItemList ()    </div>
</div><!-- fragment --><p> The layer's items are rendered when the method <em>void Visual3d_Layer::RenderLayerItems()</em> is called by the graphical driver.</p>
<p>The <em>Visual3d_LayerItem</em> has virtual methods that are used to render the item: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void  Visual3d_LayerItem::RedrawLayerPrs () </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;void  Visual3d_LayerItem::ComputeLayerPrs () </div>
</div><!-- fragment --><p>The item presentation can be computed before drawing by the <em>ComputeLayerPrs</em> method to save time on redraw. It also has an additional flag that is used to tell that the presentation should be recomputed: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void  Visual3d_LayerItem::SetNeedToRecompute (const Standard_Boolean NeedToRecompute)  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Standard_Boolean  Visual3d_LayerItem::IsNeedToRecompute </div>
</div><!-- fragment --><p>An example of <em>Visual3d_LayerItem</em> is <em>V3d_ColorScaleLayerItem</em> that represents the color scale entity as the layer's item. The <em>V3d_ColorScaleLayerItem</em> sends render requests to the color scale entity represented by it. As this entity (<em>V3d_ColorScale</em>) is assigned to the <em>V3d_LayerMgr</em> it uses its overlay layer's services for drawing:</p>
<h4>Example </h4>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// tell V3d_ColorScale to draw itself</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;void  V3d_ColorScaleLayerItem::RedrawLayerPrs () </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;{ </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;   Visual3d_LayerItem::RedrawLayerPrs () </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  if  (!MyColorScale.IsNull ()) </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    MyColorScale-&gt;DrawScale  (); </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;} </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;// V3d_ColorScale has a reference to a LayerMgr</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;void  V3d_ColorScale::DrawScale () </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;{ </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    // calls V3d_ColorScale::PaintRect,  V3d_ColorScale::PaintText, etc. </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;} </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;// PaintRect method uses overlay layer of LayerMgr to  draw a rectangle </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;void V3d_ColorScale::PaintRect   </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;       (const  Standard_Integer X, const Standard_Integer Y, </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        const  Standard_Integer W, const Standard_Integer H, </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        const  Quantity_Color aColor, </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        const  Standard_Boolean aFilled) </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{ </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  const Handle  (Visual3d_Layer)&amp; theLayer = myLayerMgr-&gt;Overlay (); </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;   ...</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   theLayer-&gt;SetColor (aColor); </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;   theLayer-&gt;DrawRectangle (X, Y, W, H); </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;   ... </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;} </div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_4_9"></a>
View background styles</h3>
<p>There are three types of background styles available for <em>V3d_view</em>: solid color, gradient color and image.</p>
<p>To set solid color for the background you can use the following methods: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void  V3d_View::SetBackgroundColor</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;     (const Quantity_TypeOfColor Type,  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;      const Quantity_Parameter V1, </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;      const Quantity_Parameter V2, </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;      const Quantity_Parameter V3) </div>
</div><!-- fragment --><p>This method allows you to specify the background color in RGB (red, green, blue) or HLS (hue, lightness, saturation) color spaces, so the appropriate values of the Type parameter are <em>Quantity_TOC_RGB</em> and <em>Quantity_TOC_HLS</em>.</p>
<p><b>Note</b> that the color value parameters <em>V1,V2,V3</em> should be in the range between <em>0.0-1.0.</em></p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void  V3d_View::SetBackgroundColor(const Quantity_Color &amp;Color)  </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;void  V3d_View::SetBackgroundColor(const Quantity_NameOfColor Name)  </div>
</div><!-- fragment --><p>The gradient background style could be set up with the following methods: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void  V3d_View::SetBgGradientColors</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;      (const Quantity_Color&amp; Color1,  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;       const Quantity_Color&amp; Color2, </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;       const Aspect_GradientFillMethod  FillStyle, </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;       const Standard_Boolean update) </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; void  V3d_View::SetBgGradientColors</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;      (const Quantity_NameOfColor Color1,  </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;       const Quantity_NameOfColor Color2, </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;       const Aspect_GradientFillMethod  FillStyle, </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;       const Standard_Boolean update) </div>
</div><!-- fragment --><p>The <em>Color1</em> and <em>Color2</em> parameters define the boundary colors of interpolation, the <em>FillStyle</em> parameter defines the direction of interpolation. You can pass <em>Standard_True</em> as the last parameter to update the view.</p>
<p>The fill style can be also set with the method <em>void <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_v3d___view.html#a571e9d25bdac49be723ef85fcd92b62b">V3d_View::SetBgGradientStyle(const Aspect_GradientFillMethod AMethod, const Standard_Boolean update)</a></em>.</p>
<p>To get the current background color you can use the following methods: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void  V3d_View::BackgroundColor</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;     (const Quantity_TypeOfColor Type,  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;      Quantity_Parameter &amp;V1, </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;      Quantity_Parameter &amp;V2, </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;      Quantity_Parameter &amp;V3) </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Quantity_Color  V3d_View::BackgroundColor()</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;void V3d_View::GradientBackgroundColors(Quantity_Color&amp; Color1, Quantity_Color&amp; Color2) </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Aspect_GradientBackground  GradientBackground()</div>
</div><!-- fragment --><p>To set the image as a background and change the background image style you can use the following methods: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void V3d_View::SetBackgroundImage</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;      (const Standard_CString FileName,  </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;       const Aspect_FillMethod FillStyle, </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;       const Standard_Boolean update) </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;void  V3d_View::SetBgImageStyle</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;      (const Aspect_FillMethod FillStyle,  </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;       const Standard_Boolean update) </div>
</div><!-- fragment --><p>The <em>FileName</em> parameter defines the image file name and the path to it, the <em>FillStyle</em> parameter defines the method of filling the background with the image. The methods are:</p><ul>
<li><em>Aspect_FM_NONE</em> &ndash; draws the image in the default position;</li>
<li><em>Aspect_FM_CENTERED</em> &ndash; draws the image at the center of the view;</li>
<li><em>Aspect_FM_TILED</em> &ndash; tiles the view with the image;</li>
<li><em>Aspect_FM_STRETCH</em> &ndash; stretches the image over the view.</li>
</ul>
<h3><a class="anchor" id="occt_visu_4_4_10"></a>
Dumping a 3D scene into an image file</h3>
<p>The 3D scene displayed in the view can be dumped in high resolution into an image file. The high resolution (8192x8192 on some implementations) is achieved using the Frame Buffer Objects (FBO) provided by the graphic driver. Frame Buffer Objects enable off-screen rendering into a virtual view to produce images in the background mode (without displaying any graphics on the screen).</p>
<p>The <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_v3d___view.html">V3d_View</a></em> has the following methods for dumping the 3D scene: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Standard_Boolean  V3d_View::Dump </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    (const Standard_CString theFile, </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;     const Image_TypeOfImage theBufferType)</div>
</div><!-- fragment --><p> Dumps the scene into an image file with the view dimensions.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Standard_Boolean  V3d_View::Dump </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    (const Standard_CString theFile, </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;     const Aspect_FormatOfSheetPaper  theFormat, </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;     const Image_TypeOfImage theBufferType)</div>
</div><!-- fragment --><p> Makes the dimensions of the output image compatible to a certain format of printing paper passed by <em>theFormat</em> argument.</p>
<p>These methods dump the 3D scene into an image file passed by its name and path as theFile.</p>
<p>The raster image data handling algorithm is based on the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_image___pix_map.html">Image_PixMap</a></em> class. The supported extensions are ".png", ".bmp", ".png", ".png".</p>
<p>The value passed as <em>theBufferType</em> argument defines the type of the buffer for an output image <em>(RGB, RGBA, floating-point, RGBF, RGBAF)</em>. Both methods return <em>Standard_True</em> if the scene has been successfully dumped.</p>
<p>There is also class <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_image___alien_pix_map.html">Image_AlienPixMap</a></em> providing import / export from / to external image files in formats supported by <b>FreeImage</b> library.</p>
<p><b>Note</b> that dumping the image for a paper format with large dimensions is a memory consuming operation, it might be necessary to take care of preparing enough free memory to perform this operation.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Handle_Image_PixMap  V3d_View::ToPixMap </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    (const Standard_Integer theWidth, </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    const Standard_Integer theHeight, </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    const Image_TypeOfImage theBufferType, </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    const Standard_Boolean theForceCentered) </div>
</div><!-- fragment --><p> Dumps the displayed 3d scene into a pixmap with a width and height passed as <em>theWidth</em> and theHeight arguments.</p>
<p>The value passed as <em>theBufferType</em> argument defines the type of the buffer for a pixmap <em>(RGB, RGBA, floating-point, RGBF, RGBAF)</em>. The last parameter allows centering the 3D scene on dumping.</p>
<p>All these methods assume that you have created a view and displayed a 3d scene in it. However, the window used for such a view could be virtual, so you can dump the 3d scene in the background mode without displaying it on the screen. To use such an opportunity you can perform the following steps:</p><ul>
<li>Create display connection;</li>
<li>Initialize graphic driver;</li>
<li>Create a window;</li>
<li>Set up the window as virtual, <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_aspect___window.html#aad977e0678c30a7eca6b1666fc439c79">Aspect_Window::SetVirtual()</a></em> ;</li>
<li>Create a view and an interactive context;</li>
<li>Assign the virtual window to the view;</li>
<li>Display a 3D scene;</li>
<li>Use one of the functions described above to dump the 3D scene.</li>
</ul>
<p>The following example demonstrates this procedure for <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_w_n_t___window.html">WNT_Window</a></em> :</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// create a dummy display  connection</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle(Aspect_DisplayConnection)  aDisplayConnection;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;// create a graphic driver</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Handle  (Graphic3d_GraphicDriver) aDriver = Graphic3d::InitGraphicDriver (aDisplayConnection); </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;// create a window</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Standard_Integer  aDefWidth  = 800; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;Standard_Integer  aDefHeight = 600; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;Handle  (WNT_WClass) aWClass =  new WNT_WClass (&quot;Virtual Class&quot;,DefWindowProc, </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                              CS_VREDRAW | CS_HREDRAW, 0, 0,  </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;                              ::LoadCursor (NULL, IDC_ARROW)); </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;Handle  (WNT_Window) aWindow =  new WNT_Window (&quot;VirtualWnd&quot;,  aWClass,  </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                              WS_OVERLAPPEDWINDOW, 0, 0,  </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;                              aDefWidth, aDefHeight); </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;// set up the window as  virtual</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;aWindow-&gt;SetVirtual  (Standard_True); </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;// create a view and an  interactive context</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;Handle  (V3d_Viewer) aViewer =  new V3d_Viewer (aDriver, </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                              Standard_ExtString (&quot;Virtual&quot;)); </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;Handle  (AIS_InteractiveContext) aContext = new AIS_InteractiveContext (aViewer); </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;Handle  (V3d_View) aView = aViewer-&gt;CreateView (); </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;// assign the virtual window  to the view</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;aView-&gt;SetWindow  (aWindow); </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;// display a 3D scene</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;Handle (AIS_Shape) aBox = new AIS_Shape (BRepPrimAPI_MakeBox (5, 5, 5)); </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;aContext-&gt;Display  (aBox); </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;aView-&gt;FitAll(); </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;// dump the 3D scene into an  image file</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;aView-&gt;Dump  (&quot;3dscene.png&quot;); </div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_4_11"></a>
Printing a 3D scene</h3>
<p>The contents of a view can be printed out. Moreover, the <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_open_gl.html">OpenGl</a> graphic driver used by the v3d view supports printing in high resolution. The print method uses the <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_open_gl.html">OpenGl</a> frame buffer (Frame Buffer Object) for rendering the view contents and advanced print algorithms that allow printing in, theoretically, any resolution.</p>
<p>The method <em>void V3d_View::Print(const Aspect_Handle hPrnDC, const Standard_Boolean showDialog, const Standard_Boolean showBackground, const Standard_CString  filename, const Aspect_PrintAlgo printAlgorithm)</em> prints the view contents:</p>
<p><em>hPrnDC</em> is the printer device handle. You can pass your own printer handle or <em>NULL</em> to select the printer by the default dialog. In that case you can use the default dialog or pass <em>Standard_False</em> as the <em>showDialog</em> argument to select the default printer automatically.</p>
<p>You can define the filename for the printer driver if you want to print out the result into a file. If you do not want to print the background, you can pass <em>Standard_False</em> as the <em>showBackground</em> argument. The <em>printAlgorithm</em> argument allows choosing between two print algorithms that define how the 3d scene is mapped to the print area when the maximum dimensions of the frame buffer are smaller than the dimensions of the print area by choosing <em>Aspect_PA_STRETCH</em> or <em>Aspect_PA_TILE</em></p>
<p>The first value defines the stretch algorithm: the scene is drawn with the maximum possible frame buffer dimensions and then is stretched to the whole printing area. The second value defines <em>TileSplit</em> algorithm: covering the whole printing area by rendering multiple parts of the viewer.</p>
<p><b>Note</b> that at the moment the printing is implemented only for Windows.</p>
<h3><a class="anchor" id="occt_visu_4_4_12"></a>
Vector image export</h3>
<p>The 3D content of a view can be exported to the vector image file format. The vector image export is powered by the <em>GL2PS</em> library. You can export 3D scenes into a file format supported by the GL2PS library: PostScript (PS), Encapsulated PostScript (EPS), Portable Document Format (PDF), Scalable Vector Graphics (SVG), LaTeX file format and Portable LaTeX Graphics (PGF).</p>
<p>The method <em>void Visual3d_View::Export (const Standard_CString FileName, const Graphic3d_ExportFormat Format, const Graphic3d_SortType aSortType, const Standard_Real <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_precision.html">Precision</a>, const Standard_Address ProgressBarFunc, const Standard_Address ProgressObject)</em> of <em>Visual3d_View</em> class allows exporting a 3D scene:</p>
<p>The <em>FileName</em> defines the output image file name and the <em>Format</em> argument defines the output file format:</p><ul>
<li><em>Graphic3d_EF_PostScript (PS)</em>,</li>
<li><em>Graphic3d_EF_EhnPostScript (EPS)</em>,</li>
<li><em>Graphic3d_EF_TEX (TEX)</em>,</li>
<li><em>Graphic3d_EF_PDF (PDF)</em>,</li>
<li><em>Graphic3d_EF_SVG (SVG)</em>,</li>
<li><em>Graphic3d_EF_PGF (PGF)</em>.</li>
</ul>
<p>The <em>aSortType</em> parameter defines <em>GL2PS</em> sorting algorithm for the primitives. The <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_precision.html">Precision</a>, ProgressBarFunc</em> and <em>ProgressObject</em> parameters are implemented for future uses and at the moment have no effect.</p>
<p>The <em>Export</em> method supports only basic 3d graphics and has several limitations:</p><ul>
<li>Rendering large scenes could be slow and can lead to large output files;</li>
<li>Transparency is only supported for PDF and SVG output;</li>
<li>Textures and some effects are not supported by the <em>GL2PS</em> library.</li>
</ul>
<h3><a class="anchor" id="occt_visu_4_4_13"></a>
Ray tracing support</h3>
<p>OCCT visualization provides rendering by real-time ray tracing technique. It is allowed to switch easily between usual rasterization and ray tracing rendering modes. The core of OCCT ray tracing is written using GLSL shaders. The ray tracing has a wide list of features:</p><ul>
<li>Hard shadows</li>
<li>Refractions</li>
<li>Reflection</li>
<li>Transparency</li>
<li>Texturing</li>
<li>Support of non-polygon objects, such as lines, text, highlighting, selection.</li>
<li>Performance optimization using 2-level bounding volume hierarchy (<a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a>).</li>
</ul>
<p>The ray tracing algorithm is recursive (Whitted's algorithm). It uses <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> effective optimization structure. The structure prepares optimized data for a scene geometry for further displaying it in real-time. The time-consuming re-computation of the <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> is not necessary for view operations, selections, animation and even editing of the scene by transforming location of the objects. It is only necessary when the list of displayed objects or their geometry changes. To make the <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/namespace_b_v_h.html">BVH</a> reusable it has been added into an individual reusable OCCT package <em>TKMath/BVH</em>.</p>
<p>There are several ray-tracing options that user can switch on/off:</p><ul>
<li>Maximum ray tracing depth</li>
<li>Shadows rendering</li>
<li>Specular reflections</li>
<li>Adaptive anti aliasing</li>
<li>Transparency shadow effects</li>
</ul>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Graphic3d_RenderingParams&amp; aParams = aView-&gt;ChangeRenderingParams();</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;// specifies rendering mode</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;aParams.Method = Graphic3d_RM_RAYTRACING;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;// maximum ray-tracing depth</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;aParams.RaytracingDepth = 3;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;// enable shadows rendering</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;aParams.IsShadowEnabled = Standard_True;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;// enable specular reflections.</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;aParams.IsReflectionEnabled = Standard_True;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;// enable adaptive anti-aliasing</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;aParams.IsAntialiasingEnabled = Standard_True;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;// enable light propagation through transparent media.</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;aParams.IsTransparentShadowEnabled = Standard_True;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;// update the view</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;aView-&gt;Update();</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_4_14"></a>
Display priorities</h3>
<p>Structure display priorities control the order, in which structures are drawn. When you display a structure you specify its priority. The lower is the value, the lower is the display priority. When the display is regenerated, the structures with the lowest priority are drawn first. The structures with the same display priority are drawn in the same order as they have been displayed. OCCT supports eleven structure display priorities.</p>
<h3><a class="anchor" id="occt_visu_4_4_15"></a>
Z-layer support</h3>
<p>OCCT features depth-arranging functionality called z-layer. A graphical presentation can be put into a z-layer. In general, this function can be used for implementing "bring to front" functionality in a graphical application.</p>
<p>Example:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// set z-layer to an interactive object</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle(AIS_InteractiveContext) aContext = ...</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Handle(AIS_InteractiveObject) anInterObj = ...</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Standard_Integer anId = 3;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;aViewer-&gt;AddZLayer (anId);</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;aContext-&gt;SetZLayer (anInterObj, anId);</div>
</div><!-- fragment --><p>For each z-layer, it is allowed to:</p><ul>
<li>Enable / disable depth test for layer.</li>
<li>Enable / disable depth write for layer.</li>
<li>Enable / disable depth buffer clearing.</li>
<li>Enable / disable polygon offset.</li>
</ul>
<p>The corresponding method <em>SetZLayerOption (...)</em> is available in <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___graphic_driver.html">Graphic3d_GraphicDriver</a></em> interface. You can get the options using getter from <em>Visual3d_ViewManager</em> and <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_v3d___viewer.html">V3d_Viewer</a></em>. It returns <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/struct_graphic3d___z_layer_settings.html">Graphic3d_ZLayerSettings</a></em> cached in <em>Visual3d_ViewManager</em> for a given <em>LayerId</em>.</p>
<p>Example: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// change z-layer settings</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Graphic3d_ZLayerSettings aSettings = aViewer-&gt;ZLayerSettings (anId);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;aSettings.EnableSetting (Graphic3d_ZLayerDepthTest);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;aSettings.EnableSetting (Graphic3d_ZLayerDepthWrite);</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;aSettings.EnableSetting (Graphic3d_ZLayerDepthClear);</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;aSettings.EnableSetting (Graphic3d_ZLayerDepthOffset);</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;aViewer-&gt;SetZLayerSettings (anId, aSettings);</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_4_16"></a>
Clipping planes</h3>
<p>The ability to define custom clipping planes could be very useful for some tasks. OCCT provides such an opportunity.</p>
<p>The <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___clip_plane.html">Graphic3d_ClipPlane</a></em> class provides the services for clipping planes: it holds the plane equation coefficients and provides its graphical representation. To set and get plane equation coefficients you can use the following methods:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Graphic3d_ClipPlane::Graphic3d_ClipPlane(const gp_Pln&amp; thePlane)</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;void Graphic3d_ClipPlane::SetEquation (const gp_Pln&amp; thePlane)</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Graphic3d_ClipPlane::Graphic3d_ClipPlane(const Equation&amp; theEquation)</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;void Graphic3d_ClipPlane::SetEquation (const Equation&amp; theEquation)</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;gp_Pln Graphic3d_ClipPlane::ToPlane() const</div>
</div><!-- fragment --><p>The clipping planes can be activated with the following method: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;void Graphic3d_ClipPlane::SetOn (const Standard_Boolean theIsOn)</div>
</div><!-- fragment --><p>The number of clipping planes is limited. You can check the limit value via method <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_graphic3d___graphic_driver.html#af48f47dae3ed4940bc6cffcdb22ab68e">Graphic3d_GraphicDriver::InquirePlaneLimit()</a></em>;</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// get the limit of clipping planes for the current view</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Standard_Integer aMaxClipPlanes = aView-&gt;Viewer()-&gt;Driver()-&gt;InquirePlaneLimit();</div>
</div><!-- fragment --><p>Let us see for example how to create a new clipping plane with custom parameters and add it to a view or to an object: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// create a new clipping plane</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;const Handle(Graphic3d_ClipPlane)&amp; aClipPlane = new Graphic3d_ClipPlane();</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;// change equation of the clipping plane</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Standard_Real aCoeffA = ...</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Standard_Real aCoeffB = ...</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Standard_Real aCoeffC = ...</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Standard_Real aCoeffD = ...</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;aClipPlane-&gt;SetEquation (gp_Pln (aCoeffA, aCoeffB, aCoeffC, aCoeffD));</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;// set capping</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;aClipPlane-&gt;SetCapping (aCappingArg == &quot;on&quot;);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;// set the material with red color of clipping plane</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;Graphic3d_MaterialAspect aMat = aClipPlane-&gt;CappingMaterial();</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;Quantity_Color aColor (1.0, 0.0, 0.0, Quantity_TOC_RGB);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;aMat.SetAmbientColor (aColor);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;aMat.SetDiffuseColor (aColor);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;aClipPlane-&gt;SetCappingMaterial (aMat);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;// set the texture of clipping plane</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;Handle(Graphic3d_Texture2Dmanual) aTexture = ...</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;aTexture-&gt;EnableModulate();</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;aTexture-&gt;EnableRepeat();</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;aClipPlane-&gt;SetCappingTexture (aTexture);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;// add the clipping plane to an interactive object</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;Handle(AIS_InteractiveObject) aIObj = ...</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;aIObj-&gt;AddClipPlane (aClipPlane);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;// or to the whole view</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;aView-&gt;AddClipPlane (aClipPlane);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;// activate the clipping plane</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;aClipPlane-&gt;SetOn(Standard_True);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;// update the view</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;aView-&gt;Update();</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_4_17"></a>
Automatic back face culling</h3>
<p>Back face culling reduces the rendered number of triangles (which improves the performance) and eliminates artifacts at shape boundaries. However, this option can be used only for solid objects, where the interior is actually invisible from any point of view. Automatic back-face culling mechanism is turned on by default, which is controlled by <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_v3d___view.html#a4d58c87080544fb1c859d576541e950c">V3d_View::SetBackFacingModel()</a></em>.</p>
<p>The following features are applied in <em>StdPrs_ToolShadedShape::IsClosed()</em>, which is used for definition of back face culling in <em>ShadingAspect</em>:</p><ul>
<li>disable culling for free closed Shells (not inside the Solid) since reversed orientation of a free Shell is a valid case;</li>
<li>enable culling for Solids packed into a compound;</li>
<li>ignore Solids with incomplete triangulation.</li>
</ul>
<p>Back face culling is turned off at TKOpenGl level in the following cases:</p><ul>
<li>clipping/capping planes are in effect;</li>
<li>for translucent objects;</li>
<li>with hatching presentation style.</li>
</ul>
<h2><a class="anchor" id="occt_visu_4_5"></a>
Examples: creating a 3D scene</h2>
<p>To create 3D graphic objects and display them in the screen, follow the procedure below:</p><ol type="1">
<li>Create attributes.</li>
<li>Create a 3D viewer.</li>
<li>Create a view.</li>
<li>Create an interactive context.</li>
<li>Create interactive objects.</li>
<li>Create primitives in the interactive object.</li>
<li>Display the interactive object.</li>
</ol>
<h3><a class="anchor" id="occt_visu_4_5_1"></a>
Create attributes</h3>
<p>Create colors.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Quantity_Color aBlack (Quantity_NOC_BLACK);</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Quantity_Color aBlue (Quantity_NOC_MATRABLUE);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Quantity_Color aBrown (Quantity_NOC_BROWN4);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Quantity_Color aFirebrick (Quantity_NOC_FIREBRICK);</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;Quantity_Color aForest (Quantity_NOC_FORESTGREEN);</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;Quantity_Color aGray (Quantity_NOC_GRAY70);</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Quantity_Color aMyColor (0.99, 0.65, 0.31, Quantity_TOC_RGB);</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Quantity_Color aBeet (Quantity_NOC_BEET);</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;Quantity_Color aWhite (Quantity_NOC_WHITE);</div>
</div><!-- fragment --><p>Create line attributes.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Handle(Graphic3d_AspectLine3d) anAspectBrown = new Graphic3d_AspectLine3d();</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle(Graphic3d_AspectLine3d) anAspectBlue = new Graphic3d_AspectLine3d();</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Handle(Graphic3d_AspectLine3d) anAspectWhite = new Graphic3d_AspectLine3d();</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;anAspectBrown-&gt;SetColor (aBrown);</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;anAspectBlue -&gt;SetColor (aBlue);</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;anAspectWhite-&gt;SetColor (aWhite);</div>
</div><!-- fragment --><p>Create marker attributes. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Handle(Graphic3d_AspectMarker3d aFirebrickMarker = new Graphic3d_AspectMarker3d();</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;// marker attributes</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;aFirebrickMarker-&gt;SetColor (Firebrick);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;aFirebrickMarker-&gt;SetScale (1.0);</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;aFirebrickMarker-&gt;SetType (Aspect_TOM_BALL);</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;// or this</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;// it is a preferred way (supports full-color images on modern hardware).</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;aFirebrickMarker-&gt;SetMarkerImage (theImage)</div>
</div><!-- fragment --><p>Create facet attributes. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Handle(Graphic3d_AspectFillArea3d) aFaceAspect =  new Graphic3d_AspectFillArea3d();</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Graphic3d_MaterialAspect aBrassMaterial (Graphic3d_NOM_BRASS);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Graphic3d_MaterialAspect aGoldMaterial  (Graphic3d_NOM_GOLD);</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;aFaceAspect-&gt;SetInteriorStyle (Aspect_IS_SOLID);</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;aFaceAspect-&gt;SetInteriorColor (aMyColor);</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;aFaceAspect-&gt;SetDistinguishOn ();</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;aFaceAspect-&gt;SetFrontMaterial (aGoldMaterial);</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;aFaceAspect-&gt;SetBackMaterial  (aBrassMaterial);</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;aFaceAspect-&gt;SetEdgeOn();</div>
</div><!-- fragment --><p>Create text attributes. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Handle(Graphic3d_AspectText3d) aTextAspect = new Graphic3d_AspectText3d (aForest, Graphic3d_NOF_ASCII_MONO, 1.0, 0.0);</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_5_2"></a>
Create a 3D Viewer (a Windows example)</h3>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;// create a default connection</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle(Aspect_DisplayConnection) aDisplayConnection;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;// create a graphic driver from default connection</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Handle(OpenGl_GraphicDriver) aGraphicDriver = new OpenGl_GraphicDriver (GetDisplayConnection());</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;// create a viewer</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;TCollection_ExtendedString aName (&quot;3DV&quot;);</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;myViewer = new V3d_Viewer (aGraphicDriver,aName.ToExtString(), &quot;&quot;);</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;// set parameters for V3d_Viewer</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;// defines default lights -</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;//   positional-light 0.3 0.0 0.0</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;//   directional-light V3d_XnegYposZpos</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;//   directional-light V3d_XnegYneg</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;//   ambient-light</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;a3DViewer-&gt;SetDefaultLights();</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;// activates all the lights defined in this viewer</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;a3DViewer-&gt;SetLightOn();</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;// set background color to black</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;a3DViewer-&gt;SetDefaultBackgroundColor (Quantity_NOC_BLACK);</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_5_3"></a>
Create a 3D view (a Windows example)</h3>
<p>It is assumed that a valid Windows window may already be accessed via the method <em>GetSafeHwnd()</em>. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Handle (WNT_Window) aWNTWindow = new WNT_Window (GetSafeHwnd());</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;myView = myViewer-&gt;CreateView();</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;myView-&gt;SetWindow (aWNTWindow);</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_5_4"></a>
Create an interactive context</h3>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;myAISContext = new AIS_InteractiveContext (myViewer);</div>
</div><!-- fragment --><p>You are now able to display interactive objects such as an <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___shape.html">AIS_Shape</a></em>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;TopoDS_Shape aShape = BRepAPI_MakeBox (10, 20, 30).Solid();</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle(AIS_Shape) anAISShape = new AIS_Shape(aShape);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;myAISContext-&gt;Display (anAISShape);</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_5_5"></a>
Create your own interactive object</h3>
<p>Follow the procedure below to compute the presentable object:</p>
<ol type="1">
<li>Build a presentable object inheriting from <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html">AIS_InteractiveObject</a></em> (refer to the Chapter on <a class="el" href="occt_user_guides__visualization.html#occt_visu_2_1">Presentable Objects</a>).</li>
<li>Reuse the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_prs3d___presentation.html">Prs3d_Presentation</a></em> provided as an argument of the compute methods.</li>
</ol>
<p><b>Note</b> that there are two compute methods: one for a standard representation, and the other for a degenerated representation, i.e. in hidden line removal and wireframe modes.</p>
<p>Let us look at the example of compute methods</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Void</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;myPresentableObject::Compute</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  (const Handle(PrsMgr_PresentationManager3d)&amp; thePrsManager,</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;   const Handle(Prs3d_Presentation)&amp; thePrs,</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;   const Standard_Integer theMode)</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;(</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  //...</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;)</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;void</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;myPresentableObject::Compute (const Handle(Prs3d_Projector)&amp; ,</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;                              const Handle(Prs3d_Presentation)&amp; thePrs)</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;(</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  //...</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;)</div>
</div><!-- fragment --><h3><a class="anchor" id="occt_visu_4_5_6"></a>
Create primitives in the interactive object</h3>
<p>Get the group used in <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_prs3d___presentation.html">Prs3d_Presentation</a></em>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Handle(Graphic3d_Group) aGroup = Prs3d_Root::CurrentGroup (thePrs);</div>
</div><!-- fragment --><p>Update the group attributes.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;aGroup-&gt;SetPrimitivesAspect (anAspectBlue);</div>
</div><!-- fragment --><p>Create two triangles in <em>aGroup</em>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Standard_Integer aNbTria = 2;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;Handle(Graphic3d_ArrayOfTriangles) aTriangles = new Graphic3d_ArrayOfTriangles (3 * aNbTria, 0, Standard_True);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;Standard_Integer anIndex;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;for (anIndex = 1; anIndex &lt;= aNbTria; nt++)</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;{</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  aTriangles-&gt;AddVertex (anIndex * 5.,      0., 0., 1., 1., 1.);</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  aTriangles-&gt;AddVertex (anIndex * 5 + 5,   0., 0., 1., 1., 1.);</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  aTriangles-&gt;AddVertex (anIndex * 5 + 2.5, 5., 0., 1., 1., 1.);</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;}</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;aGroup-&gt;BeginPrimitives();</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;aGroup-&gt;AddPrimitiveArray (aTriangles);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;aGroup-&gt;EndPrimitives();</div>
</div><!-- fragment --><p>The methods <em>BeginPrimitives()</em> and <em>EndPrimitives()</em> are used when creating a set of various primitives in the same group. Use the polyline function to create a boundary box for the <em>thePrs</em> structure in group <em>aGroup</em>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Standard_Real Xm, Ym, Zm, XM, YM, ZM;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;thePrs-&gt;MinMaxValues (Xm, Ym, Zm, XM, YM, ZM);</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;Handle(Graphic3d_ArrayOfPolylines) aPolylines = new Graphic3d_ArrayOfPolylines (16, 4);</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;aPolylines-&gt;AddBound (4);</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;aPolylines-&gt;AddVertex (Xm,  Ym, Zm);</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;aPolylines-&gt;AddVertex (Xm,  Ym, ZM);</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;aPolylines-&gt;AddVertex (Xm,  YM, ZM);</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;aPolylines-&gt;AddVertex (Xm,  YM, Zm);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;aPolylines-&gt;AddBound (4);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;aPolylines-&gt;AddVertex (Xm,  Ym, Zm);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;aPolylines-&gt;AddVertex (XM,  Ym, Zm);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;aPolylines-&gt;AddVertex (XM,  Ym, ZM);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;aPolylines-&gt;AddVertex (XM,  YM, ZM);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;aPolylines-&gt;AddBound (4);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;aPolylines-&gt;AddVertex (XM,  YM, Zm);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;aPolylines-&gt;AddVertex (XM,  Ym, Zm);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;aPolylines-&gt;AddVertex (XM,  YM, Zm);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;aPolylines-&gt;AddVertex (Xm,  YM, Zm);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;aPolylines-&gt;AddBound (4);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;aPolylines-&gt;AddVertex (Xm,  YM, ZM);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;aPolylines-&gt;AddVertex (XM,  YM, ZM);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;aPolylines-&gt;AddVertex (XM,  Ym, ZM);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;aPolylines-&gt;AddVertex (Xm,  Ym, ZM);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;aGroup-&gt;BeginPrimitives();</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;aGroup-&gt;AddPrimitiveArray(aPolylines);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;aGroup-&gt;EndPrimitives();</div>
</div><!-- fragment --><p>Create text and markers in group <em>aGroup</em>.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;static char* texte[3] =</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;{</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  &quot;Application title&quot;,</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  &quot;My company&quot;,</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  &quot;My company address.&quot;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;};</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;Handle(Graphic3d_ArrayOfPoints) aPtsArr = new Graphic3d_ArrayOfPoints (2, 1);</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;aPtsArr-&gt;AddVertex (-40.0, -40.0, -40.0);</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;aPtsArr-&gt;AddVertex (40.0, 40.0, 40.0);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;aGroup-&gt;BeginPrimitives();</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;aGroup-&gt;AddPrimitiveArray (aPtsArr);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;aGroup-&gt;EndPrimitives();</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;Graphic3d_Vertex aMarker (0.0, 0.0, 0.0);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;for (i=0; i &lt;= 2; i++)</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  aMarker.SetCoord (-(Standard_Real )i * 4 + 30,</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                     (Standard_Real )i * 4,</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;                    -(Standard_Real )i * 4);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  aGroup-&gt;Text (texte[i], Marker, 20.);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;}</div>
</div><!-- fragment --><h1><a class="anchor" id="occt_visu_5"></a>
Mesh Visualization Services</h1>
<p><em>MeshVS</em> (Mesh Visualization Service) component extends 3D visualization capabilities of Open CASCADE Technology. It provides flexible means of displaying meshes along with associated pre- and post-processor data.</p>
<p>From a developer's point of view, it is easy to integrate the <em>MeshVS</em> component into any mesh-related application with the following guidelines:</p>
<ul>
<li>Derive a data source class from the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___data_source.html">MeshVS_DataSource</a></em> class.</li>
<li>Re-implement its virtual methods, so as to give the <em>MeshVS</em> component access to the application data model. This is the most important part of the job, since visualization performance is affected by performance of data retrieval methods of your data source class.</li>
<li>Create an instance of <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___mesh.html">MeshVS_Mesh</a></em> class.</li>
<li>Create an instance of your data source class and pass it to a <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___mesh.html">MeshVS_Mesh</a></em> object through the <em>SetDataSource()</em> method.</li>
<li>Create one or several objects of <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___prs_builder.html">MeshVS_PrsBuilder</a></em>-derived classes (standard, included in the <em>MeshVS</em> package, or your custom ones).</li>
<li>Each <em>PrsBuilder</em> is responsible for drawing a <em> <a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___mesh.html">MeshVS_Mesh</a></em> presentation in a certain display mode(s) specified as a <em>PrsBuilder</em> constructor's argument. Display mode is treated by <em>MeshVS</em> classes as a combination of bit flags (two least significant bits are used to encode standard display modes: wireframe, shading and shrink).</li>
<li>Pass these objects to the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___mesh.html#abca40539ca5f64ef3e9c06a2f8aebec6">MeshVS_Mesh::AddBuilder()</a></em> method. <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___mesh.html">MeshVS_Mesh</a></em> takes advantage of improved selection highlighting mechanism: it highlights its selected entities itself, with the help of so called "highlighter" object. You can set one of <em>PrsBuilder</em> objects to act as a highlighter with the help of a corresponding argument of the <em>AddBuilder()</em> method.</li>
</ul>
<p>Visual attributes of the <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___mesh.html">MeshVS_Mesh</a></em> object (such as shading color, shrink coefficient and so on) are controlled through <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___drawer.html">MeshVS_Drawer</a></em> object. It maintains a map "Attribute ID --&gt; attribute value" and can be easily extended with any number of custom attributes.</p>
<p>In all other respects, <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_mesh_v_s___mesh.html">MeshVS_Mesh</a></em> is very similar to any other class derived from <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s___interactive_object.html">AIS_InteractiveObject</a></em> and it should be used accordingly (refer to the description of <em><a class="elRef" doxygen="D:/install/CR0-OCCT7_CR0-OCCT7/Windows-64-VC10-opt/OCCT/doc/refman/OCCT.tag:../../refman/html/" href="../../refman/html/class_a_i_s.html">AIS</a> package</em> in the documentation). </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Apr 4 2016 21:57:45 for Open CASCADE Technology by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
